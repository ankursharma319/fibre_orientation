(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    249233,       5356]
NotebookOptionsPosition[    247557,       5324]
NotebookOutlinePosition[    247903,       5339]
CellTagsIndexPosition[    247860,       5336]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"initialize", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "imgTif", ",", " ", "im", ",", " ", "imgsRed", ",", " ", "trows", ",", 
        " ", "tcols", ",", " ", "tsub", ",", " ", "tsubImg", ",", " ", 
        "img3d"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SetDirectory", "[", 
         RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"*", " ", "The", " ", "sample", " ", "tif", " ", "image"}], 
         " ", "**)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"imgTif", " ", "=", " ", 
           RowBox[{"Import", "[", "\"\<resources/sample.tif\>\"", "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"imgsRed", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"trows", ",", " ", "tcols"}], "}"}], "=", 
           RowBox[{
            RowBox[{"imgTif", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "//", "ImageDimensions"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"tsub", " ", "=", " ", 
              RowBox[{"ImageTake", "[", 
               RowBox[{
                RowBox[{"imgTif", "[", 
                 RowBox[{"[", "layer", "]"}], "]"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Floor", "[", 
                   RowBox[{"3", "*", 
                    RowBox[{"(", 
                    RowBox[{"trows", "/", "10"}], ")"}]}], "]"}], ",", 
                  RowBox[{"Floor", "[", 
                   RowBox[{"7", "*", 
                    RowBox[{"(", 
                    RowBox[{"trows", "/", "10"}], ")"}]}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Floor", "[", 
                   RowBox[{"3", "*", 
                    RowBox[{"(", 
                    RowBox[{"tcols", "/", "10"}], ")"}]}], "]"}], ",", 
                  RowBox[{"Floor", "[", 
                   RowBox[{"7", "*", 
                    RowBox[{"(", 
                    RowBox[{"tcols", "/", "10"}], ")"}]}], "]"}]}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"tsubImg", " ", "=", 
              RowBox[{"ImageResize", "[", 
               RowBox[{"tsub", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Scaled", "[", "0.08", "]"}], ",", " ", 
                  RowBox[{"Scaled", "[", "0.08", "]"}]}], "}"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"imgsRed", ",", " ", "tsubImg"}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"layer", ",", " ", "1", ",", " ", 
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"imgTif", "//", "Length"}], ")"}], "/", "4"}], 
               "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"img3d", " ", "=", " ", 
           RowBox[{"Image3D", "[", "imgsRed", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"im", " ", "=", 
           RowBox[{"getBinarizedImage3D", "[", 
            RowBox[{"img3d", ",", " ", "7", ",", " ", "1", ",", " ", 
             RowBox[{"threshold_:", "0.08"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "@", 
           RowBox[{"ImageDimensions", "@", "im"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"img", "=", 
           RowBox[{"ImageRotate", "[", 
            RowBox[{
             RowBox[{"ImageResize", "[", 
              RowBox[{"im", ",", " ", 
               RowBox[{"{", 
                RowBox[{"30", ",", " ", "30", ",", "30"}], "}"}]}], "]"}], 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"90", " ", "Degree"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{"img", ",", " ", 
             RowBox[{"Axes", "->", "True"}]}], "]"}]}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "*", " ", "Sample", " ", "half", " ", "sphere", " ", "image"}], 
          ")"}], " ", "**)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"img3d", " ", "=", " ", 
           RowBox[{"generate3DSampleImage", "[", 
            RowBox[{"60", ",", " ", "18", ",", " ", "22"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"im", " ", "=", 
           RowBox[{"getBinarizedImage3D", "[", 
            RowBox[{"img3d", ",", " ", "7", ",", " ", "1", ",", " ", 
             RowBox[{"threshold_:", "0.08"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"img", "=", "im"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{"img", ",", " ", 
             RowBox[{"Axes", "->", "True"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "*", " ", "Simple", " ", "Cylindrical", " ", "tube", " ", "for", " ",
           "testing"}], " ", "**)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"img3d", " ", "=", " ", 
           RowBox[{"generate3DSimpleImage", "[", 
            RowBox[{"40", ",", " ", "5", ",", " ", "0"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"im", " ", "=", 
           RowBox[{"getBinarizedImage3D", "[", 
            RowBox[{"img3d", ",", " ", "7", ",", " ", "1", ",", " ", 
             RowBox[{"threshold_:", "0.08"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"img", "=", "im"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{"img", ",", " ", 
             RowBox[{"Axes", "->", "True"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"img3d", " ", "=", " ", 
         Graphics3DBox[
          TagBox[Raster3DBox[CompressedData["
1:eJzs3UGqptmaluGDgjgN5yCCrcQplAOQI1a1BKFsiLPOIXh2o4istLIiYuf/
r3t9+7ku2PFF9KJxv7u5nv/w3//X3/3Dv/nLX/7yv//93/74u7/+n//yj//4
1//7X//dxz/+/q//8z/9x7//t3/76//4289//tvPf/sLAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAADArX795Z9/Ycnv+3cHLNE/i3TPMr0DAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8Aq//lL/D+B1/qnnz37hyXTP
It2zTPcs0z3L9M4i3bNM7wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAA7/HrL5/7whN8tm/982S6Z5HuWaZ7lumdZXpnke5ZpneW6Z1FegcA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG716y+f+8ITfLZv/fME
7+pb99zodO+65wZ6Z5nuWaZ3FumeZXpnmd5ZpncW6Z1legcAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAADgK/n1l5/7wpP8bN/650le3bfuudGpznVP
qepc9xTqznVPSe8s0zuLdM8yvbNM7yzTO4v0zjK9s0zvLNI7AAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAC/Zeecr+x7ff/oF270qr51z83e3bnuucHp
znVPoe5c95xU9613Tqr71j2lunO9U6h71z0lvbNM7yzSO8v0zjK9s0zvLNI7
y3QOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH/M7jlf2Z/tW/c8wbs6
1z03OdW57ilVneueQt257jmh7lrvnFD3rHtOqjvWO6W6a71TqjvXPSW9s0jv
LNM7y/TOIp2zTO8s0zvL9M4inQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
8E72QfnK7J6z4NWd658bnepc95SqzvXOSXXnuuekum/dc0Lds945qe5Z95xQ
96t3Tqr71Tulume9U6r71juFunPdU9I7y3TOIr2zTO8s0zvLdM4ivbNM5wAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAMCt7ArxFdkJZYFdaBa8u3Pdc4PTneue
Qt253jmp7lz3nFB3rXtOqnvWOyfUHeudk+qOdc8Jdbd656S6W71TqPvVO6W6
Z71TqvvWOyW9s0jvLNM7y3TOIr2zTOcs0zvLdA4AAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAHA3e1ossJ/IAvu4LLCDzoLTneueUt277jmh7lv3nFR3rXdOqHvW
PSfVHeudE+p+9c5Jdb9654S6W91zUt2r3inU3eqdUt2x3inVXeudQt23zinp
nWV6Z5HOWaZ3lumcZXpnkc4BAAAAAAAAAAAAAAAAAAAAAAAAAAAA4OvzHj9f
mZ0hFtiVY4HdUBbYh2ZB1bnuKdSd654T6q71zkl117rnpLpnvXNC3bHuOanu
V++cUHerd06qu9U7J9Xd6p2T6m71zkl1t3qnUPerd0p1z3qnVPetc0p6Z5He
WaZzlumdRTpnmc5ZpnMAAAAAAAAAAAAAAAAAAAAAAAAAAABgjXf5+crsDbHA
rhxL7CmywE40S+redc8Jdd9656S6b91zQt2z3jmp7ln3nFR3rHdOqPvVOyfV
/eqek+pu9c5Jdbd656S6W71zUt2tzjmp7lfvnFT3q3dKdc96p1B3rXNKemeZ
3lmmcxbpnGU6Z5nOAQAAAAAAAAAAAAAAAAAAAAAAAAAA+BHes+Ur8k4/C+yw
sMDOFkvsy7HAjihL6t51zwl137rnpLprvXNS3bXuOaHuWO+cVHese06q+9U7
J9X96p2T6n71zkl1v3rnpLpfvXNS3a/eOanuV++cVPerc06qO9Y7hbpnvVOo
u9Y5Jb2zTOcs0jnLdM4ynbNM3wAAAAAAAAAAAAAAAAAAAAAAAAAA8OO838wC
7/SzwB4LC+xtscTOHAvqXUXdc1Ldue45qe5b75xQd617Tqp71jsn1T3rnhPq
fvVOoe5Y75xQ96t3Tqr71Tsn1f3qnULdsd45qe5Y75xUd6x3Tqo71jsn1R3r
nJPqnvVOoe5a75xUd61zSjpnkc5ZpnOW6Ztl+gYAAAAAAAAAAAAAAAAAAAAA
AAAAgM/zjjMLvGPOAjsVLLBDxBL7WyyodxV1z0l157rnpLpv3XNS3bXeOaHu
WfecVHesd06qO9Y7J9Ud652T6o51z0l1v3rnpLpfvXNS3a/eOanuV+8U6o51
zkl1z3rnpLpnvXNS3bPOKdR9652T6r51TkHnLNI5i/TNMn0DAAAAAAAAAAAA
AAAAAAAAAAAAAMD7eeeTr8h7zizwXj9L7FSwwA4RS+xvscS+IgvqznXPSXXf
uuekumu9c1Ldte45qe5Z75xU96x7Tqo71jsn1R3rnZPqjvXOSXXHeuekumO9
c1Ldsd4p1D3rnZPqnnXOSXXXeqdQ9613Tqr71jkFnbNE5yzSN8t0DgAAAAAA
AAAAAAAAAAAAAAAAAAAAwCt4z5avzPvlLPBuP0vssrDA7hZL7CqypO5d95xU
d653Tqj71j0n1V3rnZPqrnXPSXXPeuekumfdc1Ldsd45qe5Y7xTqnvXOSXXP
euekume9c1Lds94p1F3rnZPqrvXOSXXXOqdQd653Cjpnic5ZpG+W6RwAAAAA
AAAAAAAAAAAAAAAAAAAAAADgX+f9ZhZ4p58FdlhYYn+IBfblWGI/lCV177rn
pLpzvXNS3bnuOaHuWvecVPesdwp117rnpLpnvXNS3bPeOanuWe+cVPesd06q
e9Y7hbprvXNS3bXeKdR9652T6r71TkHnLNE7i3TOIn2zSOegawAAAAAAAAAA
AAAAAAAAAAAAAAAAAIB/4p1yvjJ7FCyxN8QCO1sssaPIEvuhLKl71z0n1Z3r
npPqvvXOSXXfuuekumu9c1Ldte45qe5Z75xU96x3CnXXeuekumvdc1Lds84p
1H3rnZPqvvXOSXXfeqdQd653Cjpnic5ZpHOW6Zxl+gYAAAAAAAAAAAAAAAAA
AAAAAAAAAACAHd7jZ4HdFZbYHWKBXTmW2A1lSdW77inUveuek+rOdc9Jdd96
56S6b91zUt213jmp7lr3nFT3rHcKddd656S6a71zUt217inUXeudk+qudU6h
7lzvnFR3rncKemeRzlmic5bpnGX6BgAAAAAAAAAAAAAAAAAAAAAAAAAAAADg
K7I7wQK7Kyyxq8UC+4kssY/LErvQLKl71z0n1Z3rnpPqvvXOSXXfuuekumu9
U6j71j0n1V3rnZPqrvVOoe5b75xU9617CnXfeuekum+9U9A5S/TOIr2zSOcs
0jnL9A26BgAAAAAAAAAAAAAAAAAAAAAAAAAAAIAF3iXnK7M/wQL7QiywH8cS
O6EssY/LEjvoLKl71z0n1Z3rnZPqznXPSXXfuqdQ9613Tqr71j0n1V3rnULd
t945qe5b9xTqvvXOSXXfeqdQd653Tqo71zsFnbNI7yzSOYv0DToHAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAOBr8t4+X5F9FZbYF2KB/TiW2AdliT1ollS9655C
3bvuOanuXO+cVHeue06q+9Y9hbpvvXNS3bfuKdR9652T6r71zkl137qnUPet
dwp153rnpLpzvVPQO4t0ziKds0jnLNM5AAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAcCv7Kiywo8USe4kssYfLEjvQLDndu+4pVb3rnkLdu+45qe5c95xU9617
CnXfeuekum/dU6j71jsn1X3rnULdud45qe5c9xTqzvVOQe8s0jlL9M4ynbNI
56BvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4B72g1hgL44ldhJZYg+XJXag
WXK6d91TqnrXPYW6d91zUt257inUneudk+rOdU+h7lzvnFR3rnsKded656S6
c71T0DuLdM8SvbNI5yzSO8t0zjJ9AwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AEDHjhAL7MSxxB4oS+zgssTuOUtO9657SlXvuqdQ9657Tqo71zuFunfdc1Ld
ue4p1J3rnZPqznVPoe5c75xUd653Cnpnkd5ZpHsW6ZxFOmeZ3lmmbwAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAA4z34QC+zEscAeKEvsPrPkVO+65ya6Z8np
3nVPqepd9xTq3nVPoe5d95xUd653CnXvuuekunO9U6h71z0FvbNE7yzSO4v0
ziK9s0znLNM56BsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATrCPxQJ7iCyw
e8sSe88sObVzrn9ucLp33XMD3bOk6l33FOredc9Jded6p1D3rnsKde+656S6
c71TqHvXPQW9s0TvLNI7i/TOMr2zSOcs0zkAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAACfZw+IrsoPIEjugLLHzzJJ375vrn5uc6l333OB077rnBrpnSdW7
7inUveueQt277inonSV177qnoHcW6Z5FemeR3lmkdxbpnWU6Z5m+AQAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAPsfuIUvsf7LEzjNL7Juz5N2965+bnO5d
95Sq3nVPSfcsqXvXPQW9s6TuXfcU9M4i3bNI7yzSPYv0ziK9s0znLNI56BwA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOCz7MGxwP4nC+yZs+Rdveuem727
e/1zk1O9654bnO5d95Sq3nVPSfcs0j1L6t51T0HvLNI9i/TOIr2zSPcs0jnL
9M4ynYO+AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfpYdOL4y+7Ysse/M
klf3rn9u9u7edc9NTvWue26ie5ac7l3/lPTOIt2zSPcs0j2L9M4i3bNI7yzS
O4v0zjK9s0znoG8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgGzufLLHr
zJJX75nrn5u9q3fdc6N3965/bnK6d91zA92zpOpd95R0zyLds0TvLNI9i/TO
It2zTO8s0jvL9M4ynYO+AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgP+f
XU8W2LdlgR1zlry6d/3zBO/uXv/c5FTvuucGp3vXPTfQPUuq3nVPSfcs0j2L
9M4i3bNI7yzSPcv0zjKds0zvoG8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAANtm1ZYEdc5a8qnf98wTv6l3/3Ez3LDnVu+65wenedc8NdM8i3bOk6l33
lHTPMr2zSPcs0jvLdM8inbNM76BvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAPhg35OvzI4zS/7sfrk74Ele3bvuudm7etc/N9M9S071rn9uUPWue0q6
Z5HeWaR7FumeRXpnme5ZpHeW6Z1lemeZvgEAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAANthvZsGf3S3XP0/yqt71z5O8q3v9c6N39657bnSqe/1zg9O9
655S1bvuKemeRbpnkd5ZpnsW6Z1lumeR3lmmc9A5AAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAADwddgvZ8mf7V3/PMmre9c/N3t377rnRqe61z830T1L
Tveue0pV77rnBrpnke5ZpHcW6Z5lemeR7lmmc9A5AAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAADwddlvZsGP7pW7A76CP9u7/nmSV/euf2727t71z410
zyLds+R077rnBrpnke5ZpHsW6Z1lumeR3lmmd5bpHb7RNwAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAA8HT2ylnys727A57sVb3rnyd4V++650bv7l3/
3Ej3LNI9S073rntuoHsW6Z5FumeZ3lmmexbpnWV6B50DAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAADAk/3oXrn9cp7ss53rnyd6de/65wne3b3+ucmp
3nXPTXTPIt2z5HTvuucGumeR7lmmexbpnWW6Z5neWaZz+EbfAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAADAV2GnnK/sj/r+0S88yZ/tXf88yat71z9P
8O7u9c9NTvWue26iexbpniWne9c9N9A9y3TPIt2zTO8s0zvL9A46BwAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgCf73l653XK+gh/t3B3wFbyqd/3z
BO/qXffc7N3d65+bnOpd99zkdPf65wa6Z4neWaZ7FumeZbpnkd5ZpnfQO3zQ
NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADzP73fK/+gLT/ajnbsD
voJX9a5/nuBdveufm+meJad61z03Od29/rmB7lmid5bpnkW6Z5nuWaZ3lumd
ZToHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC+KjvNLNI9C37f+fe+
8GQ/27s74Mle1bv+eYJ39a5/bqZ7lpzqXffc5HT3+ucGumeJ3lmmexbpnmW6
Z5neWaZ30DkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPD12Glmke5Z
8PvOf/QLT/TZ3vXPE72qd/3zBO/qXf/cTPcsOdW7/rmJ7lmke5bonWW6Z5Hu
WaZ7lumdZToHnQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF+P3WYW
6Z4Ff9T5977wRJ/tXf880at61z9P8K7e9c+NTvWue25yunv9cwPds0j3LNI7
i3TPIt2zTPcs0zvLdA7f6BwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
APgq7DazSPcs+KPOv/eFJ/ls5/rniV7du/55gnd3r39ucqp33XOT093rnxvo
nkW6Z5HeWaR7FumeZbpnmd5ZpnP4RucAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAMBXYbeZRbpnwR91/r0vPMlnO9c/T/Tq3vXPE7y7e/1zk1O9656b
nO5e/9xA9yzSPYv0ziLds0j3LNM9y/TOMp3DNzoHAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAACezj45i3TPku/17g74Cj7buf55olf3rn+e4N3d65+b
nOpd99zkdPf65wa6Z5HuWaR3FumeRbpnme5ZpneW6Ry+0TkAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAPB09slZpHuWfK93d8BX8NnO9c8Tvbp3/fME
7+5e/9zkVO+65yanu9c/N9A9i3TPIt2zSO8s0j3LdM8yvbNM5/CNzgEAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgKezT84i3bPke727A76Cz3auf57o
1b3rnyd4d/f65yanetc9Nzndvf65ge5ZpHsW6Z5FemeR7lmme5bpnWU6h290
DgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfBV2m1mkexb8Ueff+8KT
fLZz/fNEr+5d/zzBu7vXPzc51bvuucnp7vXPDXTPIt2zSPcs0juLdM8y3bNM
7yzTOXyjcwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4Kuw18wi3bPg
953/6Bee5LOd658nenXv+ucJ3t29/rnJqd51z01Od69/bqB7FumeRbpnke5Z
pHeW6Z5lemeZ3kHnAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADzL
r7/83Bee6Gc71z9P9qre9c8TvKt3/XOjU73rnpuc7l7/3ED3LNI9i3TPIt2z
SO8s0z3L9M4y3YPOAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHiW
X3/5sS882Y927g74Cl7Vu/55gnf1rn9upnuWnOpd/9xE9yzSPYt0zyLds0j3
LNM7y3TPMr2zTO+gcwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHgy
O+Us+KPOv/eFJ/ps7+6AJ3p17/rnZu/uXffc5FTv+ucmumeR7lmkexbpnkW6
Z5nuWaZ3FumeZXoHvQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADw
LL/+8nNfeKKf7dwd8GSv7l3/3OzdveueG53qXv/c4HTvuucGumeR7lmkexbp
nmW6Z5nuWaR3lumeZXoHnQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AMAT2SlnwY927g74Cl7Vu/55knd1r39u9O7e9c9NTveue26gexbpnkVV9/qn
pHuW6Z1lumeR7lmme5bpnWV6h290DgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAPJWdZhb8Ueff+8ITfbZ3d8ATvbp3/XOzd/euf26kexbpniWne9c/
N9A9i3TPMt2zTPcs0j3L9M4i3YPe2aZ3AAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAeB775Cz52d71z5P92d7dAU/yrt71z41O9a57bqJ7Fp3uXv+U
qt51T0n3LNM9y3TPIt2zSPcs0z3L9M4yvYPeAQAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAACAr8M+Mwt+dp/cHfBEn+1c/zzRq3vXP0/w7u71z01O9a57
bnK6e/1zA92zpOpd99xA/yzTPYt0zyLds0zvLNM9y3TPMr2D3gEAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAgOeyz8yCn90jdwc82at61z9P8K7e9c/N
dM+SU73rn5vonkVV9/qnpHuW6Z5FumeR7lmme5bpnmW6Z5neWaZ30DsAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwFdhn5YFdslZ8tne3QFP9Ore9c/N
3t277rnRqe71zw1O9657blB1r39KumeZ7lnk9z6LdM8y3bNM9yzSPcv0zjLd
g97hg84BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJ7JHjML/uweuTvg
SV7Vu/55knd1r39u9O7e9c+NdM+i093rnxvonkVV9/qnpHsW6Z5lumeZ7lnk
9z7L9M4y3bNM96B3+KB3AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAL4S
e5wssMfMgj+7Q+4OeKJXd69/bvau3vXPzXTPklO965+bVN3rn5LuWaR7FtXd
65+S7lmmexbpnmW6Z5nuWaZ7lumeZXqHb/QOAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAwJPZ5WSJPWaWvGqP3B3wBK/uXf/c7N29654bnepe/9zkdPf6
p1T1rntKdff6p6R7FumeZfpnke5ZpnuW6Z5FumeZ7kH3bNM76B0AAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAACAZ7PLyRJ7zCx51Q65/nmCV/euf2727t71
z41Od69/bqB7FlXd65+S7llUd69/SrpnUd29/inpnmW6Z5HuWaZ7lumeZboH
3cMHnQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwRHY5WWKHmSWv3h/X
Pzd7V+/652anutc/Nzjdu+65QdW9/inV3eufku5ZVHevfwp177qnVHevf0q6
Z5HuWaZ7lumeZbpnme5B9/BB7wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
APB12CFkgT1OlthhZsmre9c/N3t37/rnRrpn0enu9c8Nqu71T6nuXv8U6t51
T6HuXf+U6t51T6nuXv8U6t51T0n3LNM/y3TPMt2zTPegd7bpHr7ROQAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAA8HR22Vhgh5Ml9pdZ8ure3QFPoHsWnepe
/9zgdO/65wZ19/qnpHsW1d3rn0Ldu/4p1b3rnkLdu/4p1b3rnpLuWaZ/lume
Zbpnme5ZpnvQO/yW3gEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgKeyw8YC
O5wssrvMErvjLHp39/rnJqd61z83qbrXP6W6e/1TqHvXPYW6d/1TqnvXP4W6
c91TqnvXP6W6d91TqrvXPyXds0j3LNM96J5tugfdwwe9AwAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAT2d/jQV2N1lid5lFdsdZ8u7e9c+NTnevf25Qda9/
SnX3+qdQ9657CnXv+qdU965/CnXnuqdU965/SnXvuqdUd69/CnXvuqdUd69/
SroH3bNN96B7+KB30DsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwFPZoWKB
vU0W2Z1lib1xFp3qXv/c4HTv+ucGdff6p1R3r38Kde+6p1D3rn9Kde/6p1B3
rn9Kdee6p1T3rn8Kdee6p1T3rn9Kde+6p1R3r39uoHuW6Z5luge9w2/pHgAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgWexOscTuIEvszbLI3jJLTvWuf25S
da9/SnX3+qdUd69/CnXv+qdQd657SnXv+qdQd65/SnXnuqdQd65/SnXn+qdU
d657SnXv+qdU9657SroH3bNN/6B3+KB7+EbnAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAADyJvSmW2F1jib1NFtlZZsnpfXH9c4Oqe/1TqrvXP4W6d/1TqnvX
P4W6c91TqDvXP6W6c/1TqjvXP4W6b91TqjvXP6W6c/1TqjvXPaW6d/1TqnvX
PTfQPcv0D7qHD3oH3QMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwTHZ2WGJv
jSX2NVliX5lF9sVZVHWvf0p19/qnUPeuf0p17/qnUHeufwp13/qnVPete0p1
5/qnUPetf0p13/qnVPete0p15/qnVHeue0p17/rnBrpnmf5B9/BB96B3+KB3
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeB57IyyxM8US+4IssS/LIrviLKq6
1z+lunv9U6h71z+lunf9U6g71z+Fum/9U6r71j+lum/dU6j71j+lum/9U6r7
1j+lum/dU6o71z+lunP9c4O6d91T0j3on226B93Db+kdvtE7AAAAAAAAAAAA
AAAAAAAAAAAAAAAAAADwFPZFWGJnhyX21VhiV5NFdpVZVHWvf0p19/qnUPeu
f0p17/qnUHeuf0p15/qnUPetf0p13/qnUHetf0p11/qnVHete0p13/qnVPet
f25Qd657SnXv+qdU9657bqB/lukedA8fdA/f6B0AAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAHgauwossS/CEvtSLLEryCK7siyyJ86iunv9U6q71z+Funf9U6g7
1z+lunP9U6j71j+lum/9U6r71j+Fumv9U6q71j+lumv9c4O6b/1TqvvWPaW6
c/1TqjvXPTeou9c/Jd2D/uGD7kH38Ft6BwAAAAAAAAAAAAAAAAAAAAAAAAAA
AAB4Ju/Is8CuAkvs6bDInhpL7GmyyJ4yy/TPorp7/VOoe9c/pbp3/VOoO3cH
FOqu9U+p7lr/lOqu9U+p7lr/FOqe9c8N6q51T6nuW/+U6r71T6nuW/+U6r51
zw3q3vVPqe5d/9xA96B7+KB70D38lt4BAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AO7mXXmW2BNhiT0pFtkTZJEdWRbZUWZR3b3+KdS9uwNKdef6p1D3rX9Kdd/6
p1B3rX9Kddf6p1R3rX9Kddf6p1R3rX9Kddf6p1R3rX9Kddf65wZ137qnVHeu
f0p15/rnBnXvuucG+gfdwwfdg+7hX6J3AAAAAAAAAAAAAAAAAAAAAAAAAAAA
AG7mHW0W2FFgkR0dlthRY5H9TBbZj2VR3b07oFT3rn8Kdef6p1R3rn8Kdd/u
gFLdtf4p1V3rn0Lds/4p1T3rn1Lds/4p1T3rn1Lds/65Qd21/inVXeufUt21
7rlB3bn+KdWd658b1L3rnlLdvf65ge7hG92D3uFfoncAAAAAAAAAAAAAAAAA
AAAAAAAAAAC4l/eDWeL9eJbYDWGJ/SgW2U9jUb2b6Q4o1d3rn0Ldu/4p1J3r
n1LduTugVPetfwp11/qnVHetf0p11/qnUPfsDijVHeufUt2x/rlB3bP+KdU9
659S3bP+KdU9654b1H3rn1Ldt/65Qd257inpHXQPH/QO3+gd9A4AAAAAAAAA
AAAAAAAAAAAAAAAAAADAnbwnzxI7IiyyH8UiO2ossqPJorp7/VOqu9c/hbp3
d0Ch7lv/lOq+9U+p7tsdUKh71j+lumf9U6p71j+lumf9U6p7dgeU6o71T6nu
WP+U6o51zw3qrvVPqe5a95TqvnXPDfQOumeb3kHv8EHv8I3eAQAAAAAAAAAA
AAAAAAAAAAAAAAAAAHgC78mzwK4Ii+xJscSOIIvsyLJM/yyqu3cHFOrO9U+p
7lz/FOq+3QGlumv9U6q71j+Fumd3QKnuWP+U6o71T6nuWP+U6o71T6nuWP/c
oO5Z/5TqnvVOqe5b99xA7yzTO+gdPuieZXoHvcMHvQMAAAAAAAAAAAAAAAAA
AAAAAAAAAAAA3M2+CEvsqrHEniaL7CizqN4RdweU6u71T6HuXf8U6s7dAaW6
b/1Tqvt2BxTqnvVPqe5Z/5Tqnt0Bpbpj/VOqO9Y/pbpj/VOqO9Y9pbpnvVOq
+9Y7N9A7y3QPemeb3kHvbNM96B0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHgO
OyMssa/GEnuyLLKrzKLT3bsDblB3r39KdffugELduf4p1Z27Awp11/qnVHft
DijVPeufQt2x/inVHbsDSnW/uqdUd6x3SnXXuqdU9613bqB3lukddM82vYPe
2aZ30D0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAd7KzxhK7siyyK86id3fv
HrhR1b3+KdXduwNKde/ugELdt/4p1X27A0p11/qnUPesf0p1z+6AUt2x7inV
PeudUt233inpnWW6Z5neQe9s0zvonm16Z5neAQD+X3t3cNwwDARBMDTmnw1D
8Fsuq4qyQC6A7f5cArPvAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWIv/UzTw
b5Ymo/+L2wEruKt7O2BmT3VvD8wk3b3+SUp3bwckpDu3A5LSfeufhHTX+icp
3bUdkJTuWe8kpfvWO0np3nVPkt5ppnea6Z1muqeZ3kHvdNM7zXQPAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAA8/Jvlibf/hu3C1Yyqnc7YCV3d28HzOjp
7u2BmaS71z8J6d7tgKR05/onId23HZCU7lrvJKU71zsJeqeZ7mmmd5rpnWZ6
p5nuQe900zvN9A4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMIer/8b9
Y2Yn/+3eHljR6N7tgBU81b0dMKNU/3ZAUrp7OyAh3bn+SUp3rneSdE8zvdNI
7zTTO810TzO900zvNNM7zXRPM70DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAACz8n+cBr87//TCSr7t3R5Y0d3d2wEzerp7O2Am6f7tgCS900jvNNM7
zXRPI73TTO800zvNdE8zvdNM7wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAWefx94WdvOv80wsrGdW9PbCSu7u3A2ake5rpnUZ6p5neaaZ7Gumd
Znqnmd5ppnsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnnAe
1y7s4Grv9sAORvWuf1akdxrpnmZ6p5HeaaZ3GumeZnoHAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAACA8c7j2oUdXO1d9+xA7zTSO810TyO9
00zvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAp87j
9cLO9E4jvdNI9wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAPDeebxe2JneaaR3GukeAAAAAOjxA8bX2zM=
            "], {{0, 57, 100}, {95, 0, 0}}, {0., 1.},
            ColorFunction->"GrayLevelDefaultColorFunction",
            Method->{"FastRendering" -> True}],
           BoxForm`ImageTag[
           "Real", ColorSpace -> Automatic, Interleaving -> None],
           Selectable->False],
          AxesStyle->{},
          Background->None,
          BoxRatios->Automatic,
          Boxed->False,
          DefaultBaseStyle->"Image3DGraphics3D",
          ImageSizeRaw->95,
          PlotRange->{{0, 95}, {0, 57}, {0, 100}},
          
          ViewPoint->{1.867412149941385, -1.8560531875071948`, 
           2.125520742640654},
          
          ViewVertical->{0.04756714078704779, 0.18376510838625612`, 
           0.981818594271433}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"img3d", "=", 
         Graphics3DBox[
          TagBox[Raster3DBox[CompressedData["
1:eJzt3cFuXTUQBuAENix5Bd6CLUu2RTxAq4aKTZBSJMTbEwmhlkLu9fjcmfiM
v09qq6b2+Ssn6bXHk/S7d7+9+eWru7u7j988//Tm7R8/PD29/fOnb59/8/Pj
x18/PD68//Hx94cPD0/fv/v6+Y3vP/sBAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADA5u4LIu7zQyoyKtYK
AABOrWbvXxGSHgEAAECQMycAAGzi4J55ZPrBvf/Q9IqMirUCAICduZsAAAAg
izMnAABsQj/c+HT9cAAAkMrdBAAAAFmcOQEAYBP64can64cDAIBU7iYAAADI
4swJAACb0A83Pl0/HAAApHI3AQAAQJYmZ86Scy0AAJza0T6yoUFd+uHy1woA
ADbW5t7A5h8AAGA9+uEiIekRAACQp6Yf7kDI2OyKDP1wAADszL1BJCQ9AgAA
gCDn2khIegQAAOTRDzc+Wz8cAAAbc28QCUmPAAAAIMi5NhKSHgEAAHn0w43P
1g8HAMDG3BtEQtIjAAAAWI9zLQAArODQhnZwx320V22djPmIY39BAAB4bV1q
+iX3BgAAAOzJ15JFQtIjAADY1rE+ssFh8yGjcysyKtYKAAAmqLdHQtIjAAAA
2JTzeSQkPQIAgG3ph9MPBwDA2am3R0LSIwAAACCNGkAkJD0CAIA1HekjGx44
GzI+syKjYq0AAOhGnToSkh4BAAAAp6bOEAlJjwAAYE364fTDAQCQSJ06EpIe
AQAAAFzWpc5QUssAAGBJR/rIZGRPBADg7LrUd9WQAQAAYBO+ti8Skh4BAMCE
+R6vwNC5kMi8ioyKtQIAoJD6biQkPQIAAADYQ5d6iZoMAMCi5vvIQoMnQmKz
ijLiEb49HADAFL1qS2UAAAAA3Iy6TyQkPQIAoJ/ZHq/Q4B79cBVrBQDA39RF
IyHpEQAAAACnorYUCUmPAAAoNtdHFhweD4nOqcioWCsAgBNQT4yEpEcAAAAA
8AX1q6Uy1MgAgGJzfWTR8dGQ8JSKjIq1AgA4SK1vqQy1PgAAAICm1OGWylCH
AwA+N9NHFo9Yr7ttIqNirQCAztTIlspQIwMAAABgaeqJS2WoJwLAicT7yGYi
IrNmWtVKMirWCgB4JWpLS2WoLQEAAABAAXXRSEh6hLooANxK6EV1bicR6j6b
a1UryahYKwDgv9RklspQkwEAAAAAhqnvLpWhvgvAJmJ9ZLMRozNnW9VKMirW
CgBORi1jqQy1DAAAAABgO+rUS2WoUwOwgkgf2XzE2Nz5VrWSjIq1AoDbUQNY
KkMNAAAAAADgpNTbl8rw/9cCcNV4H9mRiIHpY6NeM6NirQBYQJNzVJdzbZuz
MwAAAAAAvMS9wXYZ7iYAMo32kR2MuPaAg61qJRkVawXAZc6D22U4DwIAAAAA
wA34fgDbZXR5nwPMGOkjO5xw+R/zqwPWyKhYK4AkTfa7Xc4fzjgAAAAAAAAT
3Edtl9Hmzsu9GtS63kd2k4iXHnTpz1bLqFgrIKDLvsS+fbsM+10AAAAAAIBF
uR+UcdKMLh+77lK5kct9ZDdL+J+nvfT2VTMq1gq6vH7Yw8nICUmPsL8CAAAA
AADg9Jrcq3W555SxVkaXzw8ZV5/76cPp06+3/BC7v+g8GRVr9WVeznNlLJvR
5fVDxloZXT4/AAAAAAAAAG6qyV1ql7ttGTJu/eysFrKXE26dUpFRsVb/zsp6
tgwZZ8/osi8BAAAAAAAAgOV1uaPXn7hVRnp/V0UbWVGrWkUv3D85mc+XEQ5J
j2iTAQAAAAAAAABAji79JR0yKtrIalrVerw/OmUAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAk+AvjohXA

            "], {{0, 100, 100}, {100, 0, 0}}, {0, 1},
            ColorFunction->"GrayLevelDefaultColorFunction",
            Method->{"FastRendering" -> True}],
           BoxForm`ImageTag[
           "Bit", ColorSpace -> Automatic, Interleaving -> None],
           Selectable->False],
          AxesStyle->{},
          Background->None,
          BoxRatios->Automatic,
          Boxed->False,
          DefaultBaseStyle->"Image3DGraphics3D",
          ImageSizeRaw->100,
          PlotRange->{{0, 100}, {0, 100}, {0, 100}},
          ImageCache->GraphicsData["CompressedBitmap", "\<\
eJy1nHmQHNV9x3tndgXSbvfcu1pWF0aSkYQ4JIgPhBCsMEGIU7IOkJGEhNCB
kBAomEhBIGSEkLgMFmAMAl+xy4mPSv5KXKkYu8rEKZddFZMKlaOSSqqSOFVU
ksIGSXvkffq938xv3nTPIchWde/uTE+/9/u83+/7+73X3XPDxge23rVz4wPb
Nm2cce2ejbu3btt0/4zP7NpjXsp2BUFws9lWzwi6zd/j5k+1u4xdEB9U/Zls
fy2I9z28leEPs50VzJzJ38GgPeTieH82h2TNNoF/gunTJw0ODvZVKhX+7qqd
8MJ4P4kTdLuTTQymTOkdGBgIS6VSPpfLFSPzUywWu2ufmhfvI2mjx2uDowvm
k6XwnLDSN3nyQG9/f7lvcJD3+cyAPcuceJ+XtulpUtt8st+8OHlSpXLOxFJp
ijk7v2lhQjBXzjY73pd9NM36NDipXB4yr08tFArT85Pz5+YGBmbkBnK8Rw+w
rd+efWa8H0iiypE5cwbOntTXaeYtzvqxXH//zKhSmR2Wy7PMRqv0ZuKUKVPi
sa7Ypj4W7wfrhsQcIkbk2zDiPNMMTXzc9G1OX7E4r7dQmGt+0wWOp7s9qsnp
8X5q0ni2Y53f5Pl9pRLNXdA7ULgw399/ca5SuShfqfA6XeQcmBO7bdl2Yart
SFfVGeZWnUGsxhl8q5PgSvPzTPPzC/0Fmr4kVy4vNNulUal0mdl4ne5iAueF
snTlnHg/lOZJikafT2N6Pp86ANIVaCxwXfkdY9snwmIxyHwq7C8EE+gix8pA
SdyVtApM9b3Qj5hOIOkxWuAgAYhe0adPh5XCImN2kFncVy4HZ30y7C9yrB3L
fJ62JK6Dou2mjZnz0zxYwlDDs97bGt4lqovAozt08XJz8itMB6/Ml8tLcqXS
1WYbNhuvcZyM95Brf0Ktt5btBWnO/1FAvbTaWwtVervY6+01UX/xM1GleG1U
KfAax2mXgBZ9gmzB9t7+uqgubtpi3agUfs8vSXAH06PYHXAGen6V6/nSnO35
75qeX2fOt8xsy82GJRyn3QZySAnxHbtN3pqSi/eX+DEnCiS5QAYhSVs7cZlF
ymWucoMgZlzrmXGDOe9Npus3m43/GajFzrXARdtDE61M9SiT+uL9ZUkB287o
tO9X6VGwNFcs0l1MMqNTwaTrnUk3htakW4zZK3KV4kqz3ZzrL3HMsOd/9Af0
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
kyg=\
\>"]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"im", " ", "=", 
         RowBox[{"getBinarizedImage3D", "[", 
          RowBox[{"img3d", ",", " ", "7", ",", " ", "1", ",", " ", 
           RowBox[{"threshold_:", "0.08"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "@", 
         RowBox[{"ImageDimensions", "@", "im"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"img", "=", "im"}], ";", "\[IndentingNewLine]", 
        RowBox[{"img", "=", 
         RowBox[{"ImageResize", "[", 
          RowBox[{"im", ",", " ", 
           RowBox[{"{", 
            RowBox[{"100", ",", "100", ",", "100"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "@", 
         RowBox[{"Show", "[", 
          RowBox[{"img", ",", " ", 
           RowBox[{"Axes", "->", "True"}]}], "]"}]}]}], "\[IndentingNewLine]",
        "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Global", " ", "variables", " ", "for", " ", "accessing", " ", 
    "the", " ", "vectorfields", " ", "after", " ", "the", " ", "program", " ",
     "has", " ", "finished", " ", "running"}], " ", "**)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"vf1", " ", "=", " ", "Null"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vf2", "=", "Null"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vf3", "=", "Null"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vf", " ", "=", "Null"}], ";", "\[IndentingNewLine]", 
    RowBox[{"vfs1", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vfs2", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vfs3", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"oriPl", "=", "Null"}], ";"}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"perform", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nL", ",", " ", "nR", ",", " ", "nC", ",", " ", "graphic1", ",", " ", 
        "graphic2", ",", " ", "graphic3", ",", " ", "vectField1", ",", " ", 
        "vectField2", ",", " ", "vectField3", ",", "thetaField3", ",", " ", 
        "in", ",", " ", "vectorPlot3D1", ",", " ", "vectorPlot3D2", ",", " ", 
        "vectorPlot3D3", ",", " ", "vectFields1", ",", " ", "vectFields2", 
        ",", " ", "vectFields3", ",", " ", "thetaWeights", ",", "phiWeights", 
        ",", "idealThetaWeights", ",", " ", "idealPhiWeights", ",", "  ", 
        "thetaError", ",", " ", "phiError", ",", "  ", "spherePlot", ",", 
        "pointsToDraw", ",", " ", "angleRes", ",", " ", "caseNumber", ",", 
        " ", "time1", ",", " ", "time2", ",", " ", "time3", ",", " ", 
        "time4"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nL", ",", " ", "nR", ",", " ", "nC"}], "}"}], "=", 
         RowBox[{
          RowBox[{"img", "//", "ImageData"}], "//", "Dimensions"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nR", ">", "35"}], ",", " ", 
          RowBox[{
           RowBox[{"pointsToDraw", "=", "20"}], ";"}], ",", " ", 
          RowBox[{
           RowBox[{"pointsToDraw", "=", "20"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"angleRes", " ", "=", " ", "0.1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"caseNumber", " ", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"idealThetaWeights", ",", " ", "idealPhiWeights"}], "}"}], 
         " ", "=", 
         RowBox[{"idealOriWeights3D", "[", 
          RowBox[{"caseNumber", ",", " ", "angleRes", ",", " ", "img"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vectFields1", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vectFields2", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vectFields3", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"time1", " ", "=", " ", 
         RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Weighted Vector Summation Algorithm\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"vectFields1", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"vectorSummation3D", "[", 
              RowBox[{"img", ",", " ", "#"}], "]"}], " ", "&"}], "/@", " ", 
            RowBox[{"{", "5", "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vectField1", " ", "=", " ", 
           RowBox[{"normalizedVectorField3DMean", "[", "vectFields1", "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"vectorPlot3D1", " ", "=", 
           RowBox[{"ListVectorPlot3D", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"Reverse", "[", 
                RowBox[{"vectField1", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", " ", 
             RowBox[{"Axes", "\[Rule]", "True"}], ",", 
             RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", 
             RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
             RowBox[{"VectorStyle", "\[Rule]", "\"\<Arrow3D\>\""}], ",", 
             RowBox[{"VectorPoints", "\[Rule]", "pointsToDraw"}], ",", 
             RowBox[{
             "VectorColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}], ",", 
             " ", 
             RowBox[{"VectorScale", "\[Rule]", "Small"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vf1", "=", "vectField1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"ivf1", "=", 
           RowBox[{"interpolationVectorField3D", "[", 
            RowBox[{"vf1", ",", " ", "img"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vfs1", " ", "=", " ", "vectFields1"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{"vectorPlot3D1", ",", " ", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"time2", " ", "=", " ", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"thetaWeights", ",", "phiWeights", ",", "spherePlot"}], 
            "}"}], "=", 
           RowBox[{"vecFieldToAngleDistribution3D", "[", 
            RowBox[{"ivf1", ",", " ", "0.1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "@", "spherePlot"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"thetaError", ",", " ", "phiError"}], "}"}], "=", 
           RowBox[{"calculateAbsoluteError3D", "[", 
            RowBox[{
            "thetaWeights", ",", " ", "phiWeights", ",", " ", 
             "idealThetaWeights", ",", " ", "idealPhiWeights"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<For vector summation, {thetaError, phiError} = \>\"", ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{"thetaError", ",", " ", "phiError"}], "}"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Time consumed for error calculation: \>\"", ",", " ", 
            RowBox[{
             RowBox[{"TimeUsed", "[", "]"}], "-", "time2"}], ",", " ", 
            "\"\< (s)\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"time2", " ", "=", " ", 
         RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<Moment of Inertia Algorithm\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"vectFields2", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"momentOfInertia3D", "[", 
            RowBox[{"img", ",", " ", "#"}], "]"}], " ", "&"}], "/@", " ", 
          RowBox[{"{", 
           RowBox[{"5", ",", "9", ",", "13"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vectField2", " ", "=", " ", 
         RowBox[{"normalizedVectorField3DMean", "[", "vectFields2", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"vf2", "=", "vectField2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"vfs2", " ", "=", " ", "vectFields2"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"vectorPlot3D2", " ", "=", 
           RowBox[{"ListVectorPlot3D", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"Reverse", "[", 
                RowBox[{"vectField2", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", " ", 
             RowBox[{"Axes", "\[Rule]", "True"}], ",", 
             RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", 
             RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
             RowBox[{"VectorStyle", "\[Rule]", "\"\<Arrow3D\>\""}], ",", 
             RowBox[{"VectorPoints", "\[Rule]", "pointsToDraw"}], ",", 
             RowBox[{
             "VectorColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}], ",", 
             " ", 
             RowBox[{"VectorScale", "\[Rule]", "0.04"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "@", 
           RowBox[{"Show", "[", 
            RowBox[{"vectorPlot3D2", ",", " ", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"thetaWeights", ",", "phiWeights", ",", "spherePlot"}], 
          "}"}], "=", 
         RowBox[{"vecFieldToAngleDistribution3D", "[", 
          RowBox[{"vf2", ",", " ", "0.1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oriPl", "=", "spherePlot"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"thetaError", ",", " ", "phiError"}], "}"}], "=", 
         RowBox[{"calculateAbsoluteError3D", "[", 
          RowBox[{
          "thetaWeights", ",", " ", "phiWeights", ",", " ", 
           "idealThetaWeights", ",", " ", "idealPhiWeights"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<For moment of inertia summation, {thetaError, phiError} = \>\"",
           ",", " ", 
          RowBox[{"{", 
           RowBox[{"thetaError", ",", " ", "phiError"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"time3", " ", "=", " ", 
         RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"vf", " ", "=", " ", 
           RowBox[{"normalizedVectorField3DMean", "[", 
            RowBox[{"{", 
             RowBox[{"vf1", ",", " ", "vf2"}], "}"}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Time taken for Vector Summation: \>\"", ",", " ", 
            RowBox[{"time2", "-", "time1"}], ",", " ", "\"\< (s)\>\""}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Time taken for Moment of Inertia: \>\"", ",", " ", 
          RowBox[{"time3", "-", "time2"}], ",", " ", "\"\< (s)\>\""}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Time taken for Gradient Filter: \>\"", ",", " ", 
            RowBox[{"time4", "-", "time3"}], ",", " ", "\"\< (s)\>\""}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Total time consumed was: \>\"", ",", " ", 
          RowBox[{
           RowBox[{"TimeUsed", "[", "]"}], "-", "time1"}], ",", " ", 
          "\"\< (s)\>\""}], "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**", " ", "MISCELLANEOUS"}], 
    " ", "HELPER", " ", "FUNCTIONS"}], " ", 
   "*************)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"idealOriWeights3D", "[", 
     RowBox[{
      RowBox[{"case_:", "1"}], ",", " ", 
      RowBox[{"resolution_:", "0.1"}], ",", " ", "img_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "thetaWeights", ",", " ", "phiWeights", ",", "imd", ",", "mass", ",", 
        " ", "angle1Pos", ",", " ", "angle2Pos", ",", " ", "t"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"imd", "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"ImageData", "[", "img", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mass", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"Flatten", "[", "imd", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"thetaWeights", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{"90", "*", "resolution"}], "]"}], ",", "2"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"thetaWeights", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], "=", 
            RowBox[{"Round", "[", 
             RowBox[{"#", "/", "resolution"}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Round", "[", 
           RowBox[{"90", "*", "resolution"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"phiWeights", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{"360", "*", "resolution"}], "]"}], ",", "2"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"phiWeights", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], "=", 
            RowBox[{"Round", "[", 
             RowBox[{"#", "/", "resolution"}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Round", "[", 
           RowBox[{"360", "*", "resolution"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"case", "\[Equal]", "1"}], ",", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"90", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"270", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"thetaWeights", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{"mass", "/", 
                 RowBox[{"Length", "@", "thetaWeights"}]}], "]"}], ",", " ", 
               RowBox[{"Length", "@", "thetaWeights"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"case", "\[Equal]", "2"}], ",", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"90", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"270", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"180", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"360", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"thetaWeights", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{"mass", "/", 
                 RowBox[{"Length", "@", "thetaWeights"}]}], "]"}], ",", " ", 
               RowBox[{"Length", "@", "thetaWeights"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"case", "\[Equal]", "3"}], ",", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"90", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"270", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"180", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "6"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"360", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "6"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"thetaWeights", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{"mass", "/", 
                 RowBox[{"Length", "@", "thetaWeights"}]}], "]"}], ",", " ", 
               RowBox[{"Length", "@", "thetaWeights"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"case", "\[Equal]", "4"}], ",", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"t", "=", 
             RowBox[{"Round", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "4"}], ")"}], "*", 
               RowBox[{"Length", "@", "phiWeights"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"1", ";;", 
                 RowBox[{"Round", "[", 
                  RowBox[{"90", "*", "resolution"}], "]"}]}], ",", "2"}], 
               "]"}], "]"}], "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"mass", "/", "4"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "t"}], ")"}]}], "]"}], ",", "t"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Round", "[", 
                  RowBox[{"270", "*", "resolution"}], "]"}], ";;", 
                 RowBox[{"Round", "[", 
                  RowBox[{"360", "*", "resolution"}], "]"}]}], ",", "2"}], 
               "]"}], "]"}], "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"mass", "/", "4"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "t"}], "+", "2"}], ")"}]}], "]"}], ",", 
               RowBox[{"t", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"90", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"270", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"180", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "8"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"phiWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"360", "*", "resolution"}], "]"}], ",", " ", "2"}], 
               "]"}], "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{"mass", "/", "8"}], "]"}]}], ";", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"thetaWeights", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"3", "/", "4"}], ")"}], "*", 
                 RowBox[{"mass", "/", 
                  RowBox[{"Length", "@", "thetaWeights"}]}]}], "]"}], ",", 
               " ", 
               RowBox[{"Length", "@", "thetaWeights"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"thetaWeights", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"90", "*", "resolution"}], "]"}], ",", "2"}], "]"}], 
              "]"}], "+=", 
             RowBox[{"Round", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "4"}], ")"}], "*", "mass"}], "]"}]}], ";"}],
            "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"thetaWeights", ",", " ", "phiWeights"}], "}"}], "]"}], 
        ";"}], "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculateAbsoluteError3D", "[", 
     RowBox[{
     "thetaWeights1_", ",", " ", "phiWeights1_", ",", " ", "thetaWeights2_", 
      ",", " ", "phiWeights2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tp1s", ",", "tp2s", ",", " ", "pp1s", ",", " ", "pp2s", ",", " ", 
        "angle", ",", "  ", "freq1", ",", " ", "freq2", ",", " ", "tsum", ",",
         "psum", ",", "tcount", ",", "pcount", ",", "taverageAbsoluteError", 
        ",", " ", "paverageAbsoluteError"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tp1s", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tp2s", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pp1s", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pp2s", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tsum", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"psum", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"angle", ",", "freq1"}], "}"}], " ", "=", " ", 
             RowBox[{"thetaWeights1", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"angle", ",", "freq2"}], "}"}], " ", "=", " ", 
             RowBox[{"thetaWeights2", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"freq1", ">", "0"}], ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"tp1s", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"tp1s", ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"angle", ",", "freq1"}], "]"}]}], "]"}]}], ";"}], 
               ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"freq2", ">", "0"}], ",", " ", 
              RowBox[{
               RowBox[{"tp2s", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"tp2s", ",", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"angle", ",", "freq2"}], "]"}]}], "]"}]}], ";"}]}],
              "]"}], ";"}], "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "@", "thetaWeights1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"angle", ",", "freq1"}], "}"}], " ", "=", " ", 
             RowBox[{"phiWeights1", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"angle", ",", "freq2"}], "}"}], " ", "=", " ", 
             RowBox[{"phiWeights2", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"freq1", ">", "0"}], ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"pp1s", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"pp1s", ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"angle", ",", "freq1"}], "]"}]}], "]"}]}], ";"}], 
               ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"freq2", ">", "0"}], ",", " ", 
              RowBox[{
               RowBox[{"pp2s", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"pp2s", ",", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"angle", ",", "freq2"}], "]"}]}], "]"}]}], ";"}]}],
              "]"}], ";"}], "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "@", "phiWeights1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Lengths of tp1s and tp2s: \>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "@", "tp1s"}], ",", " ", 
            RowBox[{"Length", "@", "tp2s"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Lengths of pp1s and pp2s: \>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "@", "pp1s"}], ",", " ", 
            RowBox[{"Length", "@", "pp2s"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tcount", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "@", "tp1s"}], ",", " ", 
            RowBox[{"Length", "@", "tp2s"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pcount", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "@", "pp1s"}], ",", " ", 
            RowBox[{"Length", "@", "pp2s"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tsum", "+=", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"tp1s", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"tp2s", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", "tcount"}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"psum", "+=", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"pp1s", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"pp2s", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", "pcount"}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"taverageAbsoluteError", "=", 
         RowBox[{"N", "@", 
          RowBox[{"(", 
           RowBox[{"tsum", "/", "tcount"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"paverageAbsoluteError", "=", 
         RowBox[{"N", "@", 
          RowBox[{"(", 
           RowBox[{"psum", "/", "pcount"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
          "taverageAbsoluteError", ",", " ", "paverageAbsoluteError"}], "}"}],
          "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vecFieldToAngleDistribution3D", "[", 
     RowBox[{"vecField_", ",", " ", 
      RowBox[{"resolution_:", "0.1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "oriField", ",", " ", "oriPlot", ",", " ", "nL", ",", " ", "nR", ",", 
        " ", "nC", ",", " ", "nD", ",", " ", "tempsc", ",", " ", "ca", ",", 
        " ", "theta", ",", " ", "phi", ",", " ", "data", ",", " ", "scdata", 
        ",", " ", "v", ",", " ", "sv", ",", " ", "spherePlot", ",", " ", 
        "histoDis", ",", " ", "pdf", ",", " ", "p3", ",", " ", 
        "histoDisGraph", ",", " ", "sphericalPlot3d", ",", "smoothKernelDist",
         ",", " ", "thetaWeights", ",", " ", "phiWeights", ",", " ", 
        "rounded1", ",", " ", "rounded2", ",", " ", "error"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nL", ",", " ", "nR", ",", " ", "nC", ",", " ", "nD"}], 
          "}"}], "=", 
         RowBox[{"vecField", "//", "Dimensions"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Normalize", "[", "#", "]"}], "&"}], "/@", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{"vecField", ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"thetaWeights", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{"180", "*", "resolution"}], "]"}], ",", "2"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"thetaWeights", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], "=", 
            RowBox[{"Round", "[", 
             RowBox[{"#", "/", "resolution"}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Round", "[", 
           RowBox[{"180", "*", "resolution"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"phiWeights", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{"360", "*", "resolution"}], "]"}], ",", "2"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"phiWeights", "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", " ", "1"}], "]"}], "]"}], "=", 
            RowBox[{"Round", "[", 
             RowBox[{"#", "/", "resolution"}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Round", "[", 
           RowBox[{"360", "*", "resolution"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"v", " ", "=", 
             RowBox[{"data", " ", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "@", 
                 RowBox[{"v", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ">", "0.01"}], " ", "||", 
               RowBox[{
                RowBox[{"Abs", "@", 
                 RowBox[{"v", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ">", "0.01"}], " ", "||", 
               " ", 
               RowBox[{
                RowBox[{"Abs", "@", 
                 RowBox[{"v", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ">", "0.01"}]}], ",", " ", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"sv", " ", "=", " ", 
                 RowBox[{"CoordinateTransform", "[", 
                  RowBox[{
                   RowBox[{
                   "\"\<Cartesian\>\"", "\[Rule]", "\"\<Spherical\>\""}], ",",
                    " ", "v"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
                RowBox[{"theta", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"sv", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], " ", "/", " ", 
                  "Degree"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"phi", "=", 
                 RowBox[{
                  RowBox[{"sv", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "/", "Degree"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"phi", "<", "0"}], ",", 
                  RowBox[{"phi", "=", 
                   RowBox[{"360", "+", "phi"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"theta", "<", "0"}], ",", 
                  RowBox[{"theta", "=", 
                   RowBox[{"180", "+", "theta"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], " ", "&&",
                     " ", 
                    RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "0"}], " ", "&&", 
                    " ", 
                    RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}]}], 
                    ")"}]}], ",", " ", 
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"rounded1", " ", "=", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"theta", "*", "resolution"}], "]"}], "/", 
                    "resolution"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"rounded2", " ", "=", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"phi", "*", "resolution"}], "]"}], "/", 
                    "resolution"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"rounded1", "\[Equal]", "0"}], ",", " ", 
                    RowBox[{"rounded1", "=", 
                    RowBox[{"Round", "[", 
                    RowBox[{"1", "/", "resolution"}], "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"rounded2", "\[Equal]", "0"}], ",", " ", 
                    RowBox[{"rounded2", "=", "360"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<{theta, phi}\>\"", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"theta", ",", " ", "phi"}], "}"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<{theta Loc, phi Loc}\>\"", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"rounded1", "*", "resolution"}], "]"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"rounded2", "*", "resolution"}], "]"}]}], "}"}]}],
                     "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"thetaWeights", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"rounded1", "*", "resolution"}], "]"}], ",", " ", 
                    "2"}], "]"}], "]"}], "+=", "1"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"phiWeights", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"rounded2", "*", "resolution"}], "]"}], ",", " ", 
                    "2"}], "]"}], "]"}], "+=", "1"}], ";"}], 
                   "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"data", "//", "Length"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"thetaWeights", " ", "=", 
         RowBox[{"thetaWeights", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"Round", "[", 
             RowBox[{"90", "*", "resolution"}], "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"spherePlot", " ", "=", 
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{"data", ",", " ", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], ",", " ", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", " ", 
           RowBox[{"BoxRatios", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}], ",", " ", 
           RowBox[{"Boxed", "\[Rule]", "False"}], ",", " ", 
           RowBox[{"AxesOrigin", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
           RowBox[{"PlotTheme", "->", 
            RowBox[{"{", "\"\<Marketing\>\"", "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
          "thetaWeights", ",", " ", "phiWeights", ",", " ", "spherePlot"}], 
          "}"}], "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateVectorField3D", "[", 
     RowBox[{"layers_", ",", " ", "r_", ",", " ", "c_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vecField", ",", " ", "vecPlot"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vecField", "=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.5"}], ",", "1"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"layers", ",", "r", ",", " ", "c", ",", " ", "3"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vecPlot", "=", 
         RowBox[{"ListVectorPlot3D", "[", "vecField", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"vecField", ",", "vecPlot"}], "}"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"meanFilterVectorField3D", "[", 
     RowBox[{"vecField_", ",", " ", 
      RowBox[{"radius_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sum", ",", "count", ",", "nSlis", ",", "nRows", ",", "nCols", ",", 
        "nDim", ",", "res", ",", "vx", ",", "vy", ",", "vz", ",", " ", 
        "isZero"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nSlis", ",", "nRows", ",", "nCols", ",", " ", "nDim"}], 
          "}"}], "=", 
         RowBox[{"vecField", "//", "Dimensions"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", "vecField"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "=", 
             RowBox[{"vecField", "[", 
              RowBox[{"[", 
               RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"isZero", " ", "=", 
             RowBox[{"!", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "@", "vx"}], ">", "0.0001"}], " ", "||", " ", 
                RowBox[{
                 RowBox[{"Abs", "@", "vy"}], ">", "0.0001"}], " ", "||", 
                RowBox[{
                 RowBox[{"Abs", "@", "vz"}], ">", "0.0001"}]}], ")"}]}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", "isZero"}], ",", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"sum", "=", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Do", "[", 
                 RowBox[{
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "=", 
                    RowBox[{"vecField", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "l", ",", "m"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "@", "vx"}], ">", "0.0001"}], " ", "||", 
                    " ", 
                    RowBox[{
                    RowBox[{"Abs", "@", "vy"}], ">", "0.0001"}], " ", "||", 
                    RowBox[{
                    RowBox[{"Abs", "@", "vz"}], ">", "0.0001"}]}], ",", " ", 
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"sum", "+=", 
                    RowBox[{"{", 
                    RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"count", "++"}], ";"}], "\[IndentingNewLine]", 
                    ")"}]}], "]"}], ";"}], "\[IndentingNewLine]", ")"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"s", "-", "radius"}], ",", 
                    RowBox[{"s", "+", "radius"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", 
                    RowBox[{"r", "-", "radius"}], ",", 
                    RowBox[{"r", "+", "radius"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", 
                    RowBox[{"c", "-", "radius"}], ",", 
                    RowBox[{"c", "+", "radius"}]}], "}"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"count", ">", "1"}], " ", ",", 
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"res", "[", 
                    RowBox[{"[", 
                    RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}], "=", 
                    RowBox[{"N", "[", 
                    RowBox[{"sum", "/", "count"}], "]"}]}], ";"}], 
                   "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{"1", "+", "radius"}], ",", 
            RowBox[{"nSlis", "-", "radius"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", " ", 
            RowBox[{"1", "+", "radius"}], ",", 
            RowBox[{"nRows", "-", "radius"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", 
            RowBox[{"1", "+", "radius"}], ",", " ", 
            RowBox[{"nCols", "-", "radius"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "res", "]"}], ";"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"meanVectorFields3D", "[", "vecs_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"total", ",", " ", "mean"}], " ", "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"total", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"vecs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "@", "vecs"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mean", " ", "=", " ", 
         RowBox[{"N", "[", 
          RowBox[{"total", "/", 
           RowBox[{"(", 
            RowBox[{"Length", "@", "vecs"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "mean", "]"}], ";"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"normalizedVectorField3DMean", "[", "vecFields_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vecField", ",", " ", "norms", ",", " ", "norm", ",", "averageNorm", 
        ",", " ", "normalizedVecFields", ",", " ", "normalizedVecField", ",", 
        " ", "res"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"norms", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"normalizedVecFields", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"norm", "=", 
             RowBox[{"Norm", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"vecFields", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "3"}], "]"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"norms", ",", " ", "norm"}], "]"}], ";"}], 
           "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"vecFields", "//", "Length"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"averageNorm", " ", "=", " ", 
         RowBox[{"Mean", "[", "norms", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"normalizedVecField", "=", 
             RowBox[{
              RowBox[{"vecFields", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"averageNorm", "/", 
                RowBox[{"norms", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"normalizedVecFields", ",", " ", "normalizedVecField"}], 
             "]"}], ";"}], "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"vecFields", "//", "Length"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"meanVectorFields3D", "[", "normalizedVecFields", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "@", "res"}], ";"}], "\[IndentingNewLine]", ")"}]}],
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"interpolationVectorField3D", "[", 
     RowBox[{"vecField_", ",", " ", "img_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nSlis", ",", "nRows", ",", "nCols", ",", " ", "nDim", ",", " ", 
        "coordsOfNonZeroPoints", ",", " ", "res", ",", "vx", ",", "vy", ",", 
        "vz", ",", " ", "i", ",", "imgdata", ",", " ", "nearestS", ",", " ", 
        "nearestR", ",", " ", "nearestC"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nSlis", ",", "nRows", ",", "nCols", ",", " ", "nDim"}], 
          "}"}], "=", 
         RowBox[{"vecField", "//", "Dimensions"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"imgdata", " ", "=", " ", 
         RowBox[{"ImageData", "@", "img"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coordsOfNonZeroPoints", " ", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", "=", "vecField"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "=", 
             RowBox[{"vecField", "[", 
              RowBox[{"[", 
               RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "@", "vx"}], ">", "0.0001"}], " ", "||", " ", 
               RowBox[{
                RowBox[{"Abs", "@", "vy"}], ">", "0.0001"}], " ", "||", 
               RowBox[{
                RowBox[{"Abs", "@", "vz"}], ">", "0.0001"}]}], ",", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"coordsOfNonZeroPoints", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", "r", ",", "c"}], "}"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "nSlis"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", " ", "1", ",", "nRows"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "1", ",", " ", "nCols"}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"i", "=", 
             RowBox[{"imgdata", "[", 
              RowBox[{"[", 
               RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "=", 
             RowBox[{"vecField", "[", 
              RowBox[{"[", 
               RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"i", ">", "0.3"}], " ", "&&", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "@", "vx"}], ">", "0.0001"}], " ", "||", " ", 
                 RowBox[{
                  RowBox[{"Abs", "@", "vy"}], ">", "0.0001"}], " ", "||", 
                 RowBox[{
                  RowBox[{"Abs", "@", "vz"}], ">", "0.0001"}]}], ")"}]}], ",", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "nearestS", ",", " ", "nearestR", ",", " ", "nearestC"}], 
                  "}"}], " ", "=", " ", 
                 RowBox[{
                  RowBox[{"Nearest", "[", 
                   RowBox[{"coordsOfNonZeroPoints", ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", "r", ",", "c"}], "}"}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"res", "[", 
                  RowBox[{"[", 
                   RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}], "=", 
                 RowBox[{"vecField", "[", 
                  RowBox[{"[", 
                   RowBox[{
                   "nearestS", ",", " ", "nearestR", ",", " ", "nearestC"}], 
                   "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ")"}]}], 
             "]"}], ";"}], "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "nSlis"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", " ", "1", ",", "nRows"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "1", ",", " ", "nCols"}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "res", "]"}], ";"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generate3DSimpleImage", "[", 
     RowBox[{
      RowBox[{"dim_:", "20"}], ",", " ", 
      RowBox[{"rad2_:", "5"}], ",", " ", 
      RowBox[{"rad1_:", "0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"img3d", ",", " ", "myArray"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"myFunc", "[", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "r", "}"}], ",", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"r", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"dim", "/", "2"}], ")"}]}], ")"}], "^", "2"}], 
                 "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"y", "-", 
                    RowBox[{"(", 
                    RowBox[{"dim", "/", "2"}], ")"}]}], ")"}], "^", "2"}], 
                 "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"z", "-", 
                    RowBox[{"(", 
                    RowBox[{"dim", "/", "2"}], ")"}]}], ")"}], "^", "2"}]}], 
                "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"r", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", 
                   RowBox[{"(", 
                    RowBox[{"dim", "/", "2"}], ")"}]}], ")"}], "^", "2"}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y", "-", 
                   RowBox[{"(", 
                    RowBox[{"dim", "/", "2"}], ")"}]}], ")"}], "^", "2"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"r", "<", "rad2"}], " ", "&&", " ", 
                RowBox[{"r", ">", "rad1"}]}], ",", " ", 
               RowBox[{"Return", "[", "1", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "0", "]"}], ";"}], "\[IndentingNewLine]", 
            ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myArray", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"dim", ",", "dim", ",", "dim"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"myArray", "[", 
              RowBox[{"[", 
               RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}], "=", 
             RowBox[{"myFunc", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", " ", "1", ",", " ", "dim"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", " ", "1", ",", " ", "dim"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", " ", "1", ",", " ", "dim"}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"img3d", " ", "=", 
         RowBox[{"Image3D", "[", "myArray", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "@", "img3d"}], ";"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generate3DSampleImage", "[", 
     RowBox[{
      RowBox[{"dim_:", "100"}], ",", " ", 
      RowBox[{"rad1_:", "40"}], ",", " ", 
      RowBox[{"rad2_:", "45"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"img3d", ",", " ", "myArray"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"myFunc", "[", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "r", "}"}], ",", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"r", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x", "-", 
                    RowBox[{"(", 
                    RowBox[{"dim", "/", "2"}], ")"}]}], ")"}], "^", "2"}], 
                 "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"y", "-", 
                    RowBox[{"(", 
                    RowBox[{"dim", "/", "2"}], ")"}]}], ")"}], "^", "2"}], 
                 "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"z", "-", 
                    RowBox[{"(", 
                    RowBox[{"dim", "/", "2"}], ")"}]}], ")"}], "^", "2"}]}], 
                "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"r", "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", 
                   RowBox[{"(", 
                    RowBox[{"dim", "/", "2"}], ")"}]}], ")"}], "^", "2"}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y", "-", 
                   RowBox[{"(", 
                    RowBox[{"dim", "/", "2"}], ")"}]}], ")"}], "^", "2"}], 
                "+", 
                RowBox[{
                 RowBox[{"(", "z", ")"}], "^", "2"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"r", "<", "rad2"}], " ", "&&", " ", 
                RowBox[{"r", ">", "rad1"}]}], ",", " ", 
               RowBox[{"Return", "[", "1", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "0", "]"}], ";"}], "\[IndentingNewLine]", 
            ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"myArray", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"dim", ",", "dim", ",", "dim"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"myArray", "[", 
              RowBox[{"[", 
               RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}], "=", 
             RowBox[{"myFunc", "[", 
              RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", " ", "1", ",", " ", "dim"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", " ", "1", ",", " ", "dim"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", " ", "1", ",", " ", "dim"}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"img3d", " ", "=", 
         RowBox[{"Image3D", "[", "myArray", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "@", "img3d"}], ";"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**", " ", "SEGMENTATION"}], 
    " ", "BINARIZATION", " ", "FUNCTIONS"}], " ", "*************)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"firstPrincipalComponentFromRGB3D", "[", "img_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pcs", ",", " ", "pc"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pcs", " ", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"KarhunenLoeveDecomposition", "[", 
            RowBox[{"ColorSeparate", "[", "img", "]"}], "]"}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pc", "=", 
         RowBox[{"pcs", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "pc", "]"}], ";"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getBinarizedImage3D", "[", 
     RowBox[{"im_", ",", " ", 
      RowBox[{"method_:", "1"}], ",", " ", 
      RowBox[{"radius_:", "3"}], ",", " ", 
      RowBox[{"threshold_:", "0.08"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "meanFiltered", ",", " ", "gradientFiltered", ",", " ", "isrgb", ",", 
        " ", "img", ",", " ", "binarized", ",", " ", "sobelX1", ",", " ", 
        "sobelX2", ",", " ", "sobelX3", ",", " ", "sobelY1", ",", " ", 
        "sobelY2", ",", " ", "sobelY3", ",", " ", "sobelZ1", ",", " ", 
        "sobelZ2", ",", " ", "sobelZ3", ",", " ", "sobelX", ",", " ", 
        "sobelY", ",", " ", "sobelZ", ",", " ", "sobelIm"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"binarized", "=", "Null"}], ";", "\[IndentingNewLine]", 
        RowBox[{"img", "=", "im"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"img", "//", "ImageData"}], "//", "Dimensions"}], "//", 
           RowBox[{"Length", " ", ">", "3"}]}], ",", " ", 
          RowBox[{"(", 
           RowBox[{"isrgb", "=", "True"}], ")"}], ",", " ", 
          RowBox[{"(", 
           RowBox[{"isrgb", " ", "=", "False"}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"isrgb", ",", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"img", " ", "=", 
             RowBox[{"firstPrincipalComponentFromRGB3D", "[", "im", "]"}]}], 
            ";"}], "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"img", "=", 
             RowBox[{"RemoveAlphaChannel", "@", 
              RowBox[{"ColorConvert", "[", 
               RowBox[{"im", ",", "\"\<Grayscale\>\""}], "]"}]}]}], ";"}], 
           "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"meanFiltered", " ", "=", 
         RowBox[{"MeanFilter", "[", 
          RowBox[{"img", ",", "radius"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"method", "==", " ", "1"}], ",", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"binarized", "=", 
             RowBox[{"Binarize", "[", "img", "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"method", "==", " ", "2"}], ",", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"binarized", "=", 
             RowBox[{"MorphologicalBinarize", "[", 
              RowBox[{"img", ",", 
               RowBox[{"FindThreshold", "[", 
                RowBox[{"img", ",", " ", 
                 RowBox[{"Method", "\[Rule]", "\"\<Cluster\>\""}]}], "]"}]}], 
              "]"}]}], ";"}], "\[IndentingNewLine]", ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"method", "==", " ", "3"}], ",", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gradientFiltered", " ", "=", 
             RowBox[{
              RowBox[{"GradientFilter", "[", 
               RowBox[{"img", ",", "radius"}], "]"}], "//", "ImageAdjust"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"binarized", " ", "=", 
             RowBox[{"getBinarizedImage3D", "[", 
              RowBox[{"gradientFiltered", ",", " ", "1"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"method", "==", " ", "4"}], ",", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sobelX1", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "3"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "3"}], ",", 
                 RowBox[{"-", "6"}], ",", 
                 RowBox[{"-", "3"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "3"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sobelX2", "=", 
             RowBox[{"0", "*", "sobelX1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"sobelX3", "=", 
             RowBox[{
              RowBox[{"-", "1"}], "*", "sobelX1"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sobelY1", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "3", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "3"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sobelY2", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", "6", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "3"}], ",", 
                 RowBox[{"-", "6"}], ",", 
                 RowBox[{"-", "3"}]}], "}"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sobelY3", "=", "sobelY1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"sobelZ1", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "3"}], ",", "0", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"sobelZ2", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "3"}], ",", "0", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "6"}], ",", "0", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "3"}], ",", "0", ",", "3"}], "}"}]}], "}"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"sobelZ3", "=", "sobelZ1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"sobelX", " ", "=", 
             RowBox[{"{", 
              RowBox[{"sobelX1", ",", " ", "sobelX2", ",", "sobelX3"}], 
              "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"sobelY", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{"sobelY1", ",", " ", "sobelY2", ",", "sobelY3"}], 
              "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"sobelZ", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{"sobelZ1", ",", " ", "sobelZ2", ",", "sobelZ3"}], 
              "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"sobelIm", " ", "=", 
             RowBox[{
              RowBox[{"Image", "[", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ImageData", "[", 
                   RowBox[{"ImageConvolve", "[", 
                    RowBox[{"meanFiltered", ",", " ", "sobelX"}], "]"}], 
                   "]"}], "^", "2"}], " ", "+", " ", 
                 RowBox[{
                  RowBox[{"ImageData", "[", 
                   RowBox[{"ImageConvolve", "[", 
                    RowBox[{"meanFiltered", ",", " ", "sobelY"}], "]"}], 
                   "]"}], "^", "2"}], " ", "+", " ", 
                 RowBox[{
                  RowBox[{"ImageData", "[", 
                   RowBox[{"ImageConvolve", "[", 
                    RowBox[{"meanFiltered", ",", " ", "sobelZ"}], "]"}], 
                   "]"}], "^", "2"}]}], "]"}], "]"}], "//", "ImageAdjust"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"binarized", " ", "=", 
             RowBox[{"MorphologicalBinarize", "[", "sobelIm", "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"method", "==", " ", "5"}], ",", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"binarized", " ", "=", 
             RowBox[{"EdgeDetect", "[", 
              RowBox[{
               RowBox[{"GaussianFilter", "[", 
                RowBox[{"img", ",", " ", "radius"}], "]"}], ",", " ", 
               RowBox[{"Method", "\[Rule]", "\"\<Sobel\>\""}]}], "]"}]}], 
            ";"}], "\[IndentingNewLine]", ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"method", "==", " ", "6"}], ",", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"binarized", " ", "=", 
             RowBox[{"MorphologicalBinarize", "[", 
              RowBox[{"meanFiltered", ",", " ", 
               RowBox[{"{", 
                RowBox[{"threshold", ",", 
                 RowBox[{"FindThreshold", "[", "meanFiltered", "]"}]}], 
                "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ")"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"method", "==", " ", "7"}], ",", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"binarized", " ", "=", 
             RowBox[{"MorphologicalBinarize", "[", 
              RowBox[{"meanFiltered", ",", " ", 
               RowBox[{"FindThreshold", "[", "meanFiltered", "]"}]}], "]"}]}],
             ";"}], "\[IndentingNewLine]", ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "binarized", "]"}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**", " ", "WEIGHTED"}], " ", 
    "VECTOR", " ", "SUMMATION", " ", "3", "D"}], " ", 
   "*************)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vectorSummation2DPart", "[", 
     RowBox[{"imgdata_", ",", " ", "window_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "img", ",", "  ", "nRows", ",", " ", "nCols", ",", " ", "vectors", ",",
         " ", "tv", ",", " ", "center", ",", " ", "lengths", ",", " ", "l", 
        ",", " ", "weighted1Vectors", ",", " ", "images", ",", " ", "vec", 
        ",", " ", "img1", ",", " ", "img2", ",", " ", "vari", ",", " ", 
        "meanIntensity", ",", " ", "w2", ",", " ", "pixelValues", ",", " ", 
        "pixValues", ",", " ", "runningTotalX", ",", " ", "runningTotalY", 
        ",", " ", "weightedVector", ",", " ", "axialWV", ",", "vectorField", 
        ",", " ", "angleField", ",", " ", "tempv2", ",", " ", "tempv"}], 
       "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"img", " ", "=", " ", 
         RowBox[{"Image", "@", "imgdata"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nRows", ",", " ", "nCols"}], "}"}], " ", "=", " ", 
         RowBox[{"ImageDimensions", "[", "img", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vectors", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"weighted1Vectors", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lengths", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"center", " ", "=", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"window", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"i", ">=", "center"}], " ", "&&", " ", 
                 RowBox[{"j", "===", "center"}]}], ")"}]}], ",", " ", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tv", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "center"}], ")"}], ",", " ", 
                   RowBox[{"(", 
                    RowBox[{"center", "-", "j"}], ")"}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"vectors", ",", " ", "tv"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"l", " ", "=", " ", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"tv", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], " ", "+", " ", 
                   RowBox[{
                    RowBox[{"tv", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"lengths", ",", "l"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"weighted1Vectors", ",", " ", 
                  RowBox[{"tv", "/", 
                   RowBox[{"(", 
                    RowBox[{"l", "^", "2"}], ")"}]}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ")"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", "window"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "1", ",", " ", "center"}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"runningTotalX", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"nRows", ",", " ", "nCols"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"runningTotalY", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"nRows", ",", " ", "nCols"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"graphVectors", "[", 
            RowBox[{"Join", "[", 
             RowBox[{"weighted1Vectors", ",", " ", 
              RowBox[{"-", "weighted1Vectors"}]}], "]"}], "]"}], "]"}], ";"}],
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vec", " ", "=", " ", 
             RowBox[{"vectors", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"l", " ", "=", " ", 
             RowBox[{"lengths", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"img1", " ", "=", 
             RowBox[{"ImageTransformation", "[", 
              RowBox[{"img", ",", 
               RowBox[{
                RowBox[{"#", "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", "nCols"}], ",", " ", 
                   RowBox[{
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", "nRows"}]}], "}"}]}],
                 "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"img2", " ", "=", 
             RowBox[{"ImageTransformation", "[", 
              RowBox[{"img", ",", 
               RowBox[{
                RowBox[{"#", "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "/", "nCols"}], ",", 
                   " ", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "/", "nRows"}]}], 
                  "}"}]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"images", "=", 
             RowBox[{"{", 
              RowBox[{"img1", ",", " ", "img", ",", " ", "img2"}], "}"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Vector: \>\"", ",", " ", "vec"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", "images", "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"imgdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", "c"}], "]"}], "]"}], ">", "0.5"}], ",", 
                  RowBox[{"(", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"pixValues", " ", "=", " ", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<r, c : \>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"r", ",", " ", "c"}], "}"}]}], "]"}], ";"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"pixValues", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ImageData", "[", "#", "]"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", " ", "c"}], "]"}], "]"}], "&"}], "/@", 
                    " ", "images"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<pixvalues: \>\"", ",", " ", "pixValues"}], 
                    "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"True", "||", 
                    RowBox[{
                    RowBox[{"Variance", "[", "pixValues", "]"}], "!=", 
                    "0"}]}], ",", " ", 
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"meanIntensity", " ", "=", " ", 
                    RowBox[{"Mean", "[", "pixValues", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"vari", " ", "=", 
                    RowBox[{"Variance", "[", "pixValues", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<vari: \>\"", ",", " ", "vari"}], "]"}], 
                    ";"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"w2", " ", "=", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"1", "/", "3"}], "]"}], "-", 
                    RowBox[{"Sqrt", "[", "vari", "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"weightedVector", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"vec", "/", 
                    RowBox[{"(", "l", ")"}]}], ")"}], "*", "w2"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<weighted vector: \>\"", ",", "  ", 
                    "weightedVector"}], "]"}], ";"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"axialWV", " ", "=", 
                    RowBox[{"vectorAngleMultiply", "[", 
                    RowBox[{"weightedVector", ",", " ", "2"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"runningTotalX", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", " ", "c"}], "]"}], "]"}], " ", "+=", 
                    " ", 
                    RowBox[{"axialWV", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"runningTotalY", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", " ", "c"}], "]"}], "]"}], " ", "+=", 
                    " ", 
                    RowBox[{"axialWV", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
                   "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                  RowBox[{")", ",", 
                   RowBox[{"{", 
                    RowBox[{"r", ",", "20", ",", "25"}], "}"}], ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"c", ",", " ", "51", ",", " ", "52"}], "}"}]}], 
                  "]"}], ";"}], "*)"}], "\[IndentingNewLine]", ")"}], ",", 
              RowBox[{"{", 
               RowBox[{"r", ",", "center", ",", 
                RowBox[{"nRows", "-", "center"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"c", ",", " ", "center", ",", " ", 
                RowBox[{"nCols", "-", "center"}]}], "}"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "vectors", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"vectorField", " ", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nRows", ",", " ", "nCols"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"imgdata", "[", 
                RowBox[{"[", 
                 RowBox[{"r", ",", "c"}], "]"}], "]"}], ">", "0.5"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tempv", " ", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"runningTotalX", "[", 
                   RowBox[{"[", 
                    RowBox[{"r", ",", "c"}], "]"}], "]"}], ",", " ", 
                  RowBox[{"runningTotalY", "[", 
                   RowBox[{"[", 
                    RowBox[{"r", ",", "c"}], "]"}], "]"}]}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"tempv2", " ", "=", 
                RowBox[{"vectorAngleMultiply", "[", 
                 RowBox[{"tempv", ",", "0.5"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"vectorField", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", " ", "c"}], "]"}], "]"}], " ", "=", " ", 
                "tempv2"}], ";"}]}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"angleField", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "c"}], "]"}], "]"}], "=", 
                RowBox[{"ArcTan", "[", 
                 RowBox[{
                  RowBox[{"tempv2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"tempv2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "*)"}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<vector at \>\"", ",", " ", 
               RowBox[{"{", 
                RowBox[{"r", ",", " ", "c"}], "}"}], ",", " ", 
               "\"\< is : \>\"", ",", " ", 
               RowBox[{"vectorField", "[", 
                RowBox[{"[", 
                 RowBox[{"r", ",", "c"}], "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<image at \>\"", ",", " ", 
               RowBox[{"{", 
                RowBox[{"r", ",", " ", "c"}], "}"}], ",", " ", 
               "\"\< is : \>\"", ",", " ", 
               RowBox[{"imgdata", "[", 
                RowBox[{"[", 
                 RowBox[{"r", ",", "c"}], "]"}], "]"}]}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "center", ",", 
            RowBox[{"nRows", "-", "center"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "center", ",", " ", 
            RowBox[{"nCols", "-", "center"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{")", ",", 
            RowBox[{"{", 
             RowBox[{"r", ",", "15", ",", "25"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"c", ",", " ", "45", ",", " ", "55"}], "}"}]}], "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"Null", ",", " ", "vectorField"}], "}"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vectorAngleMultiply", "[", 
     RowBox[{"vec_", ",", " ", "factor_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"theta", ",", " ", "res"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"theta", "=", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{"vec", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"vec", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{
          RowBox[{"Norm", "[", "vec", "]"}], "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"factor", " ", "theta"}], "]"}], ",", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"factor", " ", "theta"}], "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"N", "@", "res"}], "]"}], ";"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calculatePhi", "[", 
     RowBox[{"beta_", ",", " ", "gamma_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"temp", ",", "phi"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"Tan", "[", "beta", "]"}]}], ")"}], "^", "2"}], " ", "+",
           " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"Tan", "[", "gamma", "]"}]}], ")"}], "^", "2"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"phi", " ", "=", " ", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"N", "@", "temp"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "phi", "]"}], ";"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"averageSlices", "[", 
     RowBox[{"slices_", ",", " ", 
      RowBox[{"dimNum_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"average", ",", " ", "sum", ",", " ", "count"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"count", " ", "=", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", "slices", "]"}], "[", 
          RowBox[{"[", "dimNum", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sum", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dimNum", "\[Equal]", "1"}], ",", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sum", " ", "=", " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"slices", "[", 
                 RowBox[{"[", 
                  RowBox[{"s", ",", " ", "All", ",", " ", "All"}], "]"}], 
                 "]"}], ")"}], ",", 
               RowBox[{"{", 
                RowBox[{"s", ",", "count"}], "}"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dimNum", "\[Equal]", "2"}], ",", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sum", " ", "=", " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"slices", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", " ", "s", ",", " ", "All"}], "]"}], 
                 "]"}], ")"}], ",", 
               RowBox[{"{", 
                RowBox[{"s", ",", "count"}], "}"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"dimNum", "\[Equal]", "3"}], ",", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sum", " ", "=", " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"slices", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", " ", "All", ",", " ", "s"}], "]"}], 
                 "]"}], ")"}], ",", 
               RowBox[{"{", 
                RowBox[{"s", ",", "count"}], "}"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"average", "=", 
         RowBox[{"sum", "/", "count"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "average", "]"}], ";"}], "\[IndentingNewLine]",
        ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addThirdComponent", "[", 
    RowBox[{"vectorField_", ",", " ", 
     RowBox[{"pos_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "result", ",", " ", "nR", ",", " ", "nL", ",", " ", "nC", ",", "nD", 
       ",", " ", "t"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nL", ",", " ", "nR", ",", " ", "nC", ",", " ", "nD"}], 
         "}"}], "=", 
        RowBox[{"vectorField", "//", "Dimensions"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"result", " ", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"nL", ",", " ", "nR", ",", " ", "nC"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pos", "\[Equal]", "1"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t", " ", "=", " ", 
                RowBox[{"vectorField", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", " ", "r", ",", " ", "c"}], "]"}], "]"}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"result", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", " ", "r", ",", " ", "c"}], "]"}], "]"}], 
                "=", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"t", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"t", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], 
              "\[IndentingNewLine]", ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", " ", "1", ",", " ", "nL"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"r", ",", " ", "1", ",", " ", "nR"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"c", ",", " ", "1", ",", " ", "nC"}], "}"}]}], "]"}], 
           ";"}], "\[IndentingNewLine]", ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pos", "\[Equal]", "2"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t", " ", "=", " ", 
                RowBox[{"vectorField", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", " ", "r", ",", " ", "c"}], "]"}], "]"}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"result", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", " ", "r", ",", " ", "c"}], "]"}], "]"}], 
                "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", 
                  RowBox[{"t", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], 
              "\[IndentingNewLine]", ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", " ", "1", ",", " ", "nL"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"r", ",", " ", "1", ",", " ", "nR"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"c", ",", " ", "1", ",", " ", "nC"}], "}"}]}], "]"}], 
           ";"}], "\[IndentingNewLine]", ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pos", "\[Equal]", "3"}], ",", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t", " ", "=", " ", 
                RowBox[{"vectorField", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", " ", "r", ",", " ", "c"}], "]"}], "]"}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"result", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", " ", "r", ",", " ", "c"}], "]"}], "]"}], 
                "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"t", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"t", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", "0"}], "}"}]}], 
               ";"}], "\[IndentingNewLine]", ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", " ", "1", ",", " ", "nL"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"r", ",", " ", "1", ",", " ", "nR"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"c", ",", " ", "1", ",", " ", "nC"}], "}"}]}], "]"}], 
           ";"}], "\[IndentingNewLine]", ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "result", "]"}], ";"}], "\[IndentingNewLine]", 
      ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vectorSummation3D", "[", 
     RowBox[{"image_", ",", " ", 
      RowBox[{"window_:", "7"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "img", ",", " ", "imgdata", ",", " ", "center", ",", " ", "nSlis", ",",
         " ", "nRows", ",", " ", "nCols", ",", " ", "xyVectors", ",", " ", 
        "yzVectors", ",", " ", "zxVectors", ",", " ", "averagedSlice", ",", 
        " ", "xyAveragedSlices", ",", " ", "yzAveragedSlices", ",", " ", 
        "zxAveragedSlices", ",", " ", "slices", ",", " ", "xyVectorField", 
        ",", " ", "yzVectorField", ",", " ", "zxVectorField", ",", " ", 
        "thetaField", ",", " ", "betaField", ",", " ", "gammaField", ",", " ",
         "phiField", ",", " ", "fieldLayer", ",", "angleFieldLayer", ",", " ",
         "totalVectorPlot3D", ",", " ", "totalVectorField", ",", " ", "t", 
        ",", " ", "tvx", ",", " ", "tvy", ",", "tvz", ",", "theta", ",", " ", 
        "phi", ",", " ", 
        RowBox[{"testX1", ":=", "5"}], ",", " ", 
        RowBox[{"testX2", ":=", "6"}], ",", " ", "timeStart", ",", " ", 
        "timeEnd"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"timeStart", " ", "=", " ", 
         RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"img", "=", 
         RowBox[{"ColorConvert", "[", 
          RowBox[{"image", ",", "\"\<GrayScale\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"imgdata", " ", "=", " ", 
         RowBox[{"ImageData", "@", "img"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}], " ",
          "=", " ", 
         RowBox[{"Dimensions", "[", "imgdata", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"center", " ", "=", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"window", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xyVectors", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"yzVectors", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zxVectors", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<{nSlis, nRows, nCols}\>\"", ",", " ", 
            RowBox[{"{", 
             RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}]}],
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<center of window: \>\"", ",", " ", "center"}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<dimensions of xyVectors: \>\"", ",", " ", 
            RowBox[{"Dimensions", "@", "xyVectors"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"xyAveragedSlices", " ", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"yzAveragedSlices", " ", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zxAveragedSlices", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"slices", " ", "=", 
             RowBox[{"imgdata", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "l"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"averagedSlice", " ", "=", 
             RowBox[{"averageSlices", "[", 
              RowBox[{"slices", ",", " ", "1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"xyAveragedSlices", ",", "averagedSlice"}], "]"}], ";"}],
            "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", " ", "1", ",", " ", 
            RowBox[{"center", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"slices", " ", "=", 
             RowBox[{"imgdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"1", ";;", "r"}], ",", "All"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"averagedSlice", " ", "=", 
             RowBox[{"averageSlices", "[", 
              RowBox[{"slices", ",", " ", "2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"zxAveragedSlices", ",", "averagedSlice"}], "]"}], ";"}],
            "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", " ", "1", ",", " ", 
            RowBox[{"center", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"slices", " ", "=", 
             RowBox[{"imgdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", " ", "All", ",", " ", 
                RowBox[{"1", ";;", "c"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"averagedSlice", " ", "=", 
             RowBox[{"averageSlices", "[", 
              RowBox[{"slices", ",", " ", "3"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"yzAveragedSlices", ",", "averagedSlice"}], "]"}], ";"}],
            "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "1", ",", " ", 
            RowBox[{"center", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"slices", " ", "=", 
             RowBox[{"imgdata", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"l", "-", "center", "+", "1"}], ";;", 
                RowBox[{"l", "+", "center", "-", "1"}]}], "]"}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"averagedSlice", " ", "=", 
             RowBox[{"averageSlices", "[", 
              RowBox[{"slices", ",", " ", "1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"xyAveragedSlices", ",", "averagedSlice"}], "]"}], ";"}],
            "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", " ", "center", ",", " ", 
            RowBox[{"nSlis", "-", "center"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"slices", " ", "=", 
             RowBox[{"imgdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{
                 RowBox[{"r", "-", "center", "+", "1"}], ";;", 
                 RowBox[{"r", "+", "center", "-", "1"}]}], ",", "All"}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"averagedSlice", " ", "=", 
             RowBox[{"averageSlices", "[", 
              RowBox[{"slices", ",", " ", "2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"zxAveragedSlices", ",", "averagedSlice"}], "]"}], ";"}],
            "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", " ", "center", ",", " ", 
            RowBox[{"nRows", "-", "center"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"slices", " ", "=", 
             RowBox[{"imgdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", " ", "All", ",", " ", 
                RowBox[{
                 RowBox[{"c", "-", "center", "+", "1"}], ";;", 
                 RowBox[{"c", "+", "center", "-", "1"}]}]}], "]"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"averagedSlice", " ", "=", 
             RowBox[{"averageSlices", "[", 
              RowBox[{"slices", ",", " ", "3"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"yzAveragedSlices", ",", "averagedSlice"}], "]"}], ";"}],
            "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "center", ",", " ", 
            RowBox[{"nCols", "-", "center"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"slices", " ", "=", 
             RowBox[{"imgdata", "[", 
              RowBox[{"[", 
               RowBox[{"l", ";;", "nSlis"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"averagedSlice", " ", "=", 
             RowBox[{"averageSlices", "[", 
              RowBox[{"slices", ",", " ", "1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"xyAveragedSlices", ",", "averagedSlice"}], "]"}], ";"}],
            "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", " ", 
            RowBox[{"nSlis", "-", "center", "+", "1"}], ",", " ", "nSlis"}], 
           "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"slices", " ", "=", 
             RowBox[{"imgdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"r", ";;", "nRows"}], ",", "All"}], "]"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"averagedSlice", " ", "=", 
             RowBox[{"averageSlices", "[", 
              RowBox[{"slices", ",", " ", "2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"zxAveragedSlices", ",", "averagedSlice"}], "]"}], ";"}],
            "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", " ", 
            RowBox[{"nRows", "-", "center", "+", "1"}], ",", " ", "nRows"}], 
           "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"slices", " ", "=", 
             RowBox[{"imgdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", " ", "All", ",", " ", 
                RowBox[{"c", ";;", "nCols"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"averagedSlice", " ", "=", 
             RowBox[{"averageSlices", "[", 
              RowBox[{"slices", ",", " ", "3"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"yzAveragedSlices", ",", "averagedSlice"}], "]"}], ";"}],
            "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", 
            RowBox[{"nCols", "-", "center", "+", "1"}], ",", "nCols"}], 
           "}"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<xyAveragedSlices : \>\"", ",", " ", 
            RowBox[{
             RowBox[{"xyAveragedSlices", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"testX1", ";;", "testX2"}], ",", 
                RowBox[{"testX1", ";;", "testX2"}], ",", " ", 
                RowBox[{"testX1", ";;", "testX2"}]}], "]"}], "]"}], " ", "//",
              " ", "MatrixForm"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<yzAveragedSlices : \>\"", ",", " ", 
            RowBox[{
             RowBox[{"yzAveragedSlices", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"testX1", ";;", "testX2"}], ",", 
                RowBox[{"testX1", ";;", "testX2"}], ",", " ", 
                RowBox[{"testX1", ";;", "testX2"}]}], "]"}], "]"}], " ", "//",
              " ", "MatrixForm"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<zxAveragesSlices : \>\"", ",", " ", 
            RowBox[{
             RowBox[{"zxAveragedSlices", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"testX1", ";;", "testX2"}], ",", 
                RowBox[{"testX1", ";;", "testX2"}], ",", " ", 
                RowBox[{"testX1", ";;", "testX2"}]}], "]"}], "]"}], " ", "//",
              " ", "MatrixForm"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<xyAveragedSlices dimensions : \>\"", ",", " ", 
            RowBox[{"Dimensions", "@", "xyAveragedSlices"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<yzAveragedSlices dimensions : \>\"", ",", " ", 
            RowBox[{"Dimensions", "@", "yzAveragedSlices"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<zxAveragedSlices dimensions : \>\"", ",", " ", 
            RowBox[{"Dimensions", "@", "zxAveragedSlices"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"xyVectorField", " ", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"yzVectorField", " ", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zxVectorField", " ", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"angleFieldLayer", ",", " ", "fieldLayer"}], "}"}], " ",
              "=", " ", 
             RowBox[{"vectorSummation2DPart", "[", 
              RowBox[{
               RowBox[{"xyAveragedSlices", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "window"}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"xyVectorField", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", " ", "All", ",", " ", "All"}], "]"}], "]"}], 
             "=", "fieldLayer"}], ";"}], "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "@", "xyAveragedSlices"}]}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"angleFieldLayer", ",", " ", "fieldLayer"}], "}"}], " ",
              "=", 
             RowBox[{"vectorSummation2DPart", "[", 
              RowBox[{
               RowBox[{"yzAveragedSlices", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "window"}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"yzVectorField", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", " ", "All", ",", " ", "i"}], "]"}], "]"}], 
             "=", "fieldLayer"}], ";"}], "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "@", "yzAveragedSlices"}]}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"angleFieldLayer", ",", " ", "fieldLayer"}], "}"}], " ",
              "=", 
             RowBox[{"vectorSummation2DPart", "[", 
              RowBox[{
               RowBox[{"zxAveragedSlices", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "window"}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"zxVectorField", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", " ", "i", ",", " ", "All"}], "]"}], "]"}], 
             "=", "fieldLayer"}], ";"}], "\[IndentingNewLine]", ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "@", "zxAveragedSlices"}]}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<xyVectorField : \>\"", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"N", "@", 
               RowBox[{"(", 
                RowBox[{"1", "/", "Degree"}], ")"}]}], "*", 
              RowBox[{"xyVectorField", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"testX1", ";;", "testX2"}], ",", 
                 RowBox[{"testX1", ";;", "testX2"}], ",", " ", 
                 RowBox[{"testX1", ";;", "testX2"}]}], "]"}], "]"}]}], " ", "//",
              " ", "MatrixForm"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<yzVectorField : \>\"", ",", " ", 
            RowBox[{
             RowBox[{"yzVectorField", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"testX1", ";;", "testX2"}], ",", 
                RowBox[{"testX1", ";;", "testX2"}], ",", " ", 
                RowBox[{"testX1", ";;", "testX2"}]}], "]"}], "]"}], " ", "//",
              " ", "MatrixForm"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<zxVectorField : \>\"", ",", " ", 
            RowBox[{
             RowBox[{"zxVectorField", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"testX1", ";;", "testX2"}], ",", 
                RowBox[{"testX1", ";;", "testX2"}], ",", " ", 
                RowBox[{"testX1", ";;", "testX2"}]}], "]"}], "]"}], " ", "//",
              " ", "MatrixForm"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<xyVectorField dimensions : \>\"", ",", " ", 
            RowBox[{"Dimensions", "@", "xyVectorField"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<yzVectorField dimensions : \>\"", ",", " ", 
            RowBox[{"Dimensions", "@", "yzVectorField"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<zxVectorField dimensions : \>\"", ",", " ", 
            RowBox[{"Dimensions", "@", "zxVectorField"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"totalVectorField", " ", "=", 
         RowBox[{
          RowBox[{"addThirdComponent", "[", 
           RowBox[{"xyVectorField", ",", " ", "3"}], "]"}], "+", 
          RowBox[{"addThirdComponent", "[", 
           RowBox[{"yzVectorField", ",", " ", "1"}], "]"}], "+", 
          RowBox[{"addThirdComponent", "[", 
           RowBox[{"zxVectorField", ",", " ", "2"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t", " ", "=", 
         RowBox[{"N", "@", 
          RowBox[{"FindThreshold", "[", "img", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"imgdata", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", " ", "r", ",", " ", "c"}], "]"}], "]"}], 
              "<", "t"}], ",", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"totalVectorField", "[", 
                 RowBox[{"[", 
                  RowBox[{"s", ",", " ", "r", ",", " ", "c"}], "]"}], "]"}], 
                "=", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
              "\[IndentingNewLine]", ")"}], ",", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"totalVectorField", "[", 
                    RowBox[{"[", 
                    RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "<", "0"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"totalVectorField", "[", 
                    RowBox[{"[", 
                    RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}], "=", 
                   RowBox[{"-", 
                    RowBox[{"totalVectorField", "[", 
                    RowBox[{"[", 
                    RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}]}]}], 
                  ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"totalVectorField", "[", 
                  RowBox[{"[", 
                   RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}], "=", 
                 RowBox[{"Normalize", "[", 
                  RowBox[{"totalVectorField", "[", 
                   RowBox[{"[", 
                    RowBox[{"s", ",", " ", "r", ",", " ", "c"}], "]"}], "]"}],
                   "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"phiField", "[", 
                  RowBox[{"[", 
                   RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}], "=", 
                 RowBox[{"calculatePhi", "[", 
                  RowBox[{
                   RowBox[{"betaField", "[", 
                    RowBox[{"[", 
                    RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}], ",", 
                   RowBox[{"gammaField", "[", 
                    RowBox[{"[", 
                    RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"theta", " ", "=", 
                 RowBox[{"thetaField", "[", 
                  RowBox[{"[", 
                   RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"phi", " ", "=", 
                 RowBox[{"phiField", "[", 
                  RowBox[{"[", 
                   RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tvx", "=", 
                 RowBox[{
                  RowBox[{"Cos", " ", "[", "theta", "]"}], " ", 
                  RowBox[{"Sin", "[", "phi", "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tvy", " ", "=", 
                 RowBox[{
                  RowBox[{"Sin", "[", "theta", "]"}], " ", 
                  RowBox[{"Sin", "[", "phi", "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tvz", " ", "=", " ", 
                 RowBox[{"Cos", "[", "phi", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"totalVectorField", "[", 
                  RowBox[{"[", 
                   RowBox[{"s", ",", "r", ",", "c"}], "]"}], "]"}], "=", 
                 RowBox[{"{", 
                  RowBox[{"tvx", ",", " ", "tvy", ",", " ", "tvz"}], "}"}]}], 
                ";"}], "*)"}], "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", " ", "1", ",", " ", "nRows"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "1", ",", " ", "nCols"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"s", ",", " ", "1", ",", " ", "nSlis"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<totalVectorField : \>\"", ",", " ", 
            RowBox[{
             RowBox[{"totalVectorField", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"testX1", ";;", "testX2"}], ",", 
                RowBox[{"testX1", ";;", "testX2"}], ",", " ", 
                RowBox[{"testX1", ";;", "testX2"}]}], "]"}], "]"}], " ", "//",
              " ", "MatrixForm"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<totalVectorField dimensions : \>\"", ",", " ", 
            RowBox[{"Dimensions", "@", "totalVectorField"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"timeEnd", " ", "=", " ", 
         RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Vector Summation one pass with window=\>\"", ",", "window", 
          ",", "\"\< and image size {slices, rows, columns}=\>\"", ",", " ", 
          RowBox[{"{", 
           RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}], 
          ",", "\"\< took \>\"", ",", " ", 
          RowBox[{"timeEnd", "-", "timeStart"}], ",", " ", "\"\< (s)\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", " ", "[", "totalVectorField", "]"}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**", " ", "MOMENT"}], " ", 
    "OF", " ", "INERTIA", " ", "3", "D"}], " ", "*************)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"changeAxis", "[", "v_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "vtemp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vtemp", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"v", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "vtemp", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"drawGraph3d", "[", 
     RowBox[{"img_", ",", " ", "centroid_", ",", "vec_", ",", " ", 
      RowBox[{"enab_:", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "timg", ",", " ", "gr", ",", " ", "gra", ",", " ", "raster", ",", " ", 
        "line", ",", "nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "enab"}], ",", " ", 
         RowBox[{"Return", " ", "[", "Null", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"timg", " ", "=", " ", 
        RowBox[{"ImageReflect", "[", 
         RowBox[{
          RowBox[{"ImageReflect", "[", 
           RowBox[{"img", ",", 
            RowBox[{"Front", "\[Rule]", "Back"}]}], "]"}], ",", 
          RowBox[{"Top", "\[Rule]", "Bottom"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"raster", " ", "=", 
        RowBox[{"Raster3D", "[", 
         RowBox[{
          RowBox[{"timg", "//", "ImageData"}], ",", " ", 
          RowBox[{"ColorFunction", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "x", "}"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5", ",", "1", ",", 
               RowBox[{"x", "/", "2"}]}], "]"}]}], "]"}]}], ",", " ", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<VolumeLighting\>\"", "\[Rule]", "True"}], ",", 
             RowBox[{"\"\<InterpolateValues\>\"", "\[Rule]", "True"}]}], 
            "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}], "=", 
        RowBox[{
         RowBox[{"img", "//", "ImageData"}], "//", "Dimensions"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"SameQ", "[", 
           RowBox[{"vec", ",", "Null"}], "]"}]}], ",", " ", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"line", "=", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"centroid", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", "nCols", ")"}], "vec"}], "+", "centroid"}]}], 
               "}"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"gr", " ", "=", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"raster", ",", " ", "Red", ",", 
                RowBox[{"Point", "[", "centroid", "]"}], ",", "Red", ",", " ",
                 "line"}], "}"}], ",", 
              RowBox[{"Axes", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "nCols"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "nRows"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "nSlis"}], "}"}]}], "}"}]}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "gr", "]"}], ";"}], "\[IndentingNewLine]", 
          ")"}], ",", " ", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"gra", " ", "=", 
            RowBox[{"Graphics3D", "[", 
             RowBox[{
              RowBox[{"{", "raster", "}"}], ",", 
              RowBox[{"Axes", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "nCols"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "nRows"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "nSlis"}], "}"}]}], "}"}]}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "gra", "]"}], ";"}], "\[IndentingNewLine]", 
          ")"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"findSym3d", "[", 
     RowBox[{"img_", ",", " ", 
      RowBox[{"forceSingle_:", "False"}], ",", " ", 
      RowBox[{"graphEnabled_:", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "imd", ",", " ", "timg", ",", " ", "nx", ",", "ny", ",", " ", "nz", 
        ",", " ", "points", ",", "weights", ",", "mass", ",", "com", ",", 
        "centroid", ",", " ", "centroids", ",", " ", "count", ",", " ", "v1", 
        ",", " ", "v2", ",", " ", "v3", ",", " ", "vtemp1", ",", " ", 
        "vtemp2", ",", " ", "vtemp3", ",", " ", "vec", ",", " ", "lengths", 
        ",", " ", "widths", ",", " ", "pointsCom", ",", "diag", ",", 
        "inertia", ",", "masks", ",", "shapes", ",", "subImgs", ",", " ", 
        "gr", ",", " ", "graaf", ",", " ", 
        RowBox[{"multiEnabled", "=", "True"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"imd", "=", 
        RowBox[{"Transpose", "@", 
         RowBox[{"ImageData", "[", 
          RowBox[{"RemoveAlphaChannel", "@", 
           RowBox[{"ColorConvert", "[", 
            RowBox[{"img", ",", "\"\<Grayscale\>\""}], "]"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nx", ",", "ny", ",", " ", "nz"}], "}"}], "=", 
        RowBox[{"Dimensions", "[", "imd", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"weights", "=", 
        RowBox[{"Flatten", "[", "imd", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mass", "=", 
        RowBox[{"Total", "[", "weights", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Mass: \>\"", ",", " ", "mass"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mass", "\[Equal]", "0"}], "||", 
          RowBox[{"mass", "\[Equal]", "1"}]}], ",", " ", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "Null", ",", " ", "Null", ",", " ", "Null", ",", 
            " ", "Null", ",", " ", "Null"}], " ", "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mass", "/", 
           RowBox[{"(", 
            RowBox[{"nx", "*", "ny", "*", "nz"}], ")"}]}], "<", "0.005"}], 
         ",", " ", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "Null", ",", " ", "Null", ",", " ", "Null", ",", 
            " ", "Null", ",", " ", "Null"}], " ", "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mass", "/", 
           RowBox[{"(", 
            RowBox[{"nx", "*", "ny", "*", "nz"}], ")"}]}], ">", "0.99"}], ",",
          " ", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "Null", ",", " ", "Null", ",", " ", "Null", ",", 
            " ", "Null", ",", " ", "Null"}], " ", "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"count", " ", "=", 
        RowBox[{
         RowBox[{"Values", "[", 
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{"img", ",", " ", "\"\<LabelCount\>\""}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"centroids", " ", "=", 
        RowBox[{"Values", "[", 
         RowBox[{"ComponentMeasurements", "[", 
          RowBox[{"img", ",", " ", "\"\<Centroid\>\""}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"!", "forceSingle"}], ")"}], " ", "&&", " ", 
          "multiEnabled", " ", "&&", 
          RowBox[{"count", ">", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"lengths", " ", "=", " ", 
            RowBox[{"Values", "[", 
             RowBox[{"ComponentMeasurements", "[", 
              RowBox[{"img", ",", " ", "\"\<Length\>\""}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"widths", " ", "=", " ", 
            RowBox[{"Values", "[", 
             RowBox[{"ComponentMeasurements", "[", 
              RowBox[{"img", ",", " ", "\"\<Width\>\""}], "]"}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"masks", " ", "=", 
            RowBox[{"Values", "[", 
             RowBox[{"ComponentMeasurements", "[", 
              RowBox[{"img", ",", " ", "\"\<Mask\>\""}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"shapes", " ", "=", " ", 
            RowBox[{"Values", "[", 
             RowBox[{"ComponentMeasurements", "[", 
              RowBox[{"img", ",", " ", "\"\<Shape\>\""}], "]"}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"subImgs", " ", "=", 
            RowBox[{"Values", "[", 
             RowBox[{"ComponentMeasurements", "[", 
              RowBox[{"img", ",", " ", "\"\<Image\>\""}], "]"}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Centroids_Default = \>\"", ",", " ", "centroids"}],
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Masks = \>\"", ",", " ", "masks"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Shapes = \>\"", ",", " ", "shapes"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<sub Imges = \>\"", ",", " ", "subImgs"}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Vectors = \>\"", ",", " ", "vecs"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"gr", "=", 
            RowBox[{"drawGraph3d", "[", 
             RowBox[{
             "img", ",", "Null", ",", " ", "Null", ",", " ", "graphEnabled"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{
             "count", ",", " ", "Null", ",", " ", "gr", ",", " ", "Null", ",",
               " ", "masks", ",", " ", "subImgs"}], "}"}], "]"}], ";"}], 
          "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"points", "=", 
        RowBox[{"Tuples", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Reverse", "@", 
            RowBox[{"Range", "[", "nx", "]"}]}], ",", 
           RowBox[{"Reverse", "@", 
            RowBox[{"Range", "[", "ny", "]"}]}], ",", " ", 
           RowBox[{"Range", "[", "nz", "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c"}], "}"}], " ", "From", " ", 
          "front", " ", "view"}], ",", " ", 
         RowBox[{"a", " ", "represents", " ", "depth"}], " ", ",", " ", 
         RowBox[{"b", " ", "represents", " ", "height"}], ",", " ", 
         RowBox[{"c", " ", "represents", " ", "width"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"com", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"points", " ", "weights"}], "]"}], "/", "mass"}], "//", 
         "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pointsCom", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Subtract", "[", 
             RowBox[{"#", ",", "com"}], "]"}], "&"}], "/@", "points"}], ")"}],
          " ", "weights"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"diag", "=", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", ".", "#"}], ")"}], "&"}], "/@", "pointsCom"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"inertia", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"i", ",", "j"}], "]"}], " ", "diag"}], "-", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "&"}], "/@", 
             "pointsCom"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2", ",", " ", "v3"}], "}"}], "=", 
        RowBox[{"Eigenvectors", "[", "inertia", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vtemp1", ",", " ", "vtemp2", ",", " ", "vtemp3"}], "}"}], 
        " ", "=", 
        RowBox[{"changeAxis", "/@", 
         RowBox[{"{", 
          RowBox[{"v1", ",", " ", "v2", ",", " ", "v3"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"vec", " ", "=", " ", "vtemp3"}], ";", "\[IndentingNewLine]", 
       RowBox[{"centroid", " ", "=", 
        RowBox[{"centroids", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"graaf", " ", "=", " ", 
        RowBox[{"drawGraph3d", "[", 
         RowBox[{
         "img", ",", " ", "centroid", ",", " ", "vec", ",", " ", 
          "graphEnabled"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "count", ",", " ", "vec", ",", " ", "graaf", ",", " ", "centroid", 
          ",", " ", "Null", ",", " ", "Null"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"resetVectorField3D", "[", "img_", "]"}], ":=", 
    RowBox[{"Module", " ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "j", ",", "k", ",", " ", "nSlis", ",", "nRows", ",", " ", 
        "nCols", ",", " ", "vectorField"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"sli", "=", "y"}], ",", " ", 
        RowBox[{"row", "=", "z"}], ",", " ", 
        RowBox[{"col", "=", 
         RowBox[{"x", " ", "in", " ", "front", " ", "view"}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vectorField", " ", "=", 
        RowBox[{"img", "//", "ImageData"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nSlis", ",", "nRows", ",", " ", "nCols"}], "}"}], " ", "=", 
        " ", 
        RowBox[{"Dimensions", "@", "vectorField"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"vectorField", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "i", ",", " ", "j"}], "]"}], "]"}], "==", 
             "0"}], ",", " ", 
            RowBox[{
             RowBox[{"vectorField", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], "=", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
            RowBox[{
             RowBox[{"vectorField", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}], "=", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", " ", "1", ",", " ", "nSlis"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "nRows"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "1", ",", " ", "nCols"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "vectorField", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"saveVectorFieldInFile3D", "[", "vectorField_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{"\"\<vect3d.dat\>\"", ",", "vectorField"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"momentOfInertia3D", "[", 
     RowBox[{"img_", ",", " ", 
      RowBox[{"pixFactor_:", "10"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vectorField", ",", " ", "row1", ",", " ", "row2", ",", " ", "col1", 
        ",", " ", "col2", ",", " ", "sli1", ",", " ", "sli2", ",", " ", 
        "nRows", ",", " ", "nCols", ",", "\[IndentingNewLine]", " ", "nSlis", 
        ",", " ", "subIm", ",", " ", "count", ",", " ", "vec", ",", " ", 
        "graff", ",", " ", "cen", ",", " ", "masks", ",", " ", "subImages", 
        ",", " ", "cnt", ",", " ", "ve", ",", " ", "gra", ",", " ", "ce", ",",
         " ", "mks", ",", " ", "sI", ",", " ", "timeStart", ",", " ", 
        "timeEnd"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"timeStart", " ", "=", " ", 
         RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vectorField", " ", "=", 
         RowBox[{"resetVectorField3D", "[", "img", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}], "=", 
         RowBox[{"Dimensions", "@", 
          RowBox[{"ImageData", "@", "img"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"row1", "=", " ", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nRows", "/", "pixFactor"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"row2", " ", "=", " ", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nRows", "/", "pixFactor"}], ")"}], "*", "i"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"col1", "=", " ", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nCols", "/", "pixFactor"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"j", "-", "1"}], ")"}]}], "+", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"col2", " ", "=", " ", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nCols", "/", "pixFactor"}], ")"}], "*", "j"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"sli1", " ", "=", " ", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nSlis", "/", "pixFactor"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"h", "-", "1"}], ")"}]}], "+", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"sli2", " ", "=", " ", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nSlis", "/", "pixFactor"}], ")"}], "*", "h"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"subIm", " ", "=", " ", 
            RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
             RowBox[{"img", ",", 
              RowBox[{"{", 
               RowBox[{"sli1", ",", " ", "sli2"}], "}"}], ",", 
              RowBox[{"{", " ", 
               RowBox[{"row1", ",", " ", "row2"}], "}"}], ",", 
              RowBox[{"{", " ", 
               RowBox[{"col1", ",", " ", "col2"}], " ", "}"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "count", ",", " ", "vec", ",", " ", "graff", ",", " ", "cen", 
              ",", " ", "masks", ",", " ", "subImages"}], "}"}], "=", 
            RowBox[{"findSym3d", "[", "subIm", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"count", "\[Equal]", "0"}], ",", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Do", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"vectorField", "[", 
                    RowBox[{"[", 
                    RowBox[{"hi", ",", " ", "k", ",", "l"}], "]"}], "]"}], "===", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", " ", "1"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"vectorField", "[", 
                    RowBox[{"[", 
                    RowBox[{"hi", ",", " ", "k", ",", " ", "l"}], "]"}], 
                    "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ";"}]
                  , "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", " ", "row1", ",", " ", "row2"}], "}"}], 
                 ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", " ", "col1", ",", " ", "col2"}], "}"}], 
                 ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"hi", ",", " ", "sli1", ",", " ", "sli2"}], "}"}]}],
                 "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
              ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"count", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"SameQ", "[", 
                  RowBox[{"vec", ",", "Null"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"vec", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "<", "0"}], ",", 
                    RowBox[{"vec", "=", 
                    RowBox[{"-", "vec"}]}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Do", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"vectorField", "[", 
                    RowBox[{"[", 
                    RowBox[{"hi", ",", " ", "k", ",", "l"}], "]"}], "]"}], "===", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", " ", "1"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"vectorField", "[", 
                    RowBox[{"[", 
                    RowBox[{"hi", ",", " ", "k", ",", " ", "l"}], "]"}], 
                    "]"}], "=", "vec"}]}], "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", " ", "row1", ",", " ", "row2"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", " ", "col1", ",", " ", "col2"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"hi", ",", " ", "sli1", ",", " ", "sli2"}], 
                    "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
                 "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "]"}],
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Window: Slice \>\"", ",", " ", "sli1", ",", " ", 
               "\"\< to \>\"", ",", " ", "sli2", ",", " ", "\"\<, Row \>\"", 
               ",", " ", "row1", ",", " ", "\"\< to \>\"", ",", " ", "row2", 
               ",", " ", "\"\< , Column \>\"", ",", " ", "col1", ",", " ", 
               "\"\< to \>\"", ",", " ", "col2"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Count = \>\"", ",", "count"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Centroid = \>\"", ",", " ", "cen"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Vector(s) = \>\"", ",", " ", "vec"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "graff", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"count", ">", "1"}], ",", " ", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Do", "[", 
                RowBox[{
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "cnt", ",", " ", "ve", ",", " ", "gra", ",", " ", "ce", 
                    ",", " ", "mks", ",", " ", "sI"}], "}"}], "=", 
                    RowBox[{"findSym3d", "[", 
                    RowBox[{
                    RowBox[{"subImages", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", " ", "True"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<#\>\"", ",", "m", ",", 
                    "\"\< SubImage Centroid = \>\"", ",", " ", "ce"}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<#\>\"", ",", "m", ",", "\"\< SubImage Vector = \>\"",
                     ",", " ", "ve"}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<#\>\"", ",", "m", ",", " ", "\"\< Mask = \>\"", ",", 
                    " ", 
                    RowBox[{"masks", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<#\>\"", ",", "m", ",", " ", "\"\< SubImage = \>\"", 
                    ",", " ", 
                    RowBox[{"subImages", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", "gra", "]"}], ";"}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"SameQ", "[", 
                    RowBox[{"ve", ",", "Null"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ve", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "<", "0"}], ",", 
                    RowBox[{"ve", "=", 
                    RowBox[{"-", "ve"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"masks", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", 
                    RowBox[{"hi", "-", "sli1", "+", "1"}], ",", " ", 
                    RowBox[{"k", "-", "row1", "+", "1"}], ",", " ", 
                    RowBox[{"l", "-", "col1", "+", "1"}]}], "]"}], "]"}], "===",
                     "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"vectorField", "[", 
                    RowBox[{"[", 
                    RowBox[{"hi", ",", " ", "k", ",", " ", "l"}], "]"}], 
                    "]"}], "=", "ve"}], ";"}]}], "\[IndentingNewLine]", "]"}],
                     ";"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", " ", "row1", ",", " ", "row2"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", " ", "col1", ",", " ", "col2"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"hi", ",", " ", "sli1", ",", " ", "sli2"}], 
                    "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ")"}], ",", " ", 
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"masks", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", " ", 
                    RowBox[{"hi", "-", "sli1", "+", "1"}], ",", " ", 
                    RowBox[{"k", "-", "row1", "+", "1"}], ",", " ", 
                    RowBox[{"l", "-", "col1", "+", "1"}]}], "]"}], "]"}], "===",
                     "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"vectorField", "[", 
                    RowBox[{"[", 
                    RowBox[{"hi", ",", " ", "k", ",", " ", "l"}], "]"}], 
                    "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", " ", "row1", ",", " ", "row2"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", " ", "col1", ",", " ", "col2"}], "}"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"hi", ",", " ", "sli1", ",", " ", "sli2"}], 
                    "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
                    "]"}], ";"}], "\[IndentingNewLine]", ")"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", " ", "1", ",", " ", "count"}], "}"}]}], 
                "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vectorField", "[", 
                  RowBox[{"[", 
                   RowBox[{"hi", ",", " ", "k", ",", "l"}], "]"}], "]"}], "===", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", " ", "1"}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<Problematic point: sli = \>\"", ",", "hi", ",", 
                   "\"\<, row = \>\"", ",", "k", ",", "\"\<, col = \>\"", ",",
                    "l"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
              ";"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", " ", "row1", ",", " ", "row2"}], "}"}], ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"l", ",", " ", "col1", ",", " ", "col2"}], "}"}], ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"hi", ",", " ", "sli1", ",", " ", "sli2"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", " ", "pixFactor"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", " ", "pixFactor"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"h", ",", " ", "1", ",", " ", "pixFactor"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"timeEnd", " ", "=", " ", 
         RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Moment of Inertia one pass with iteration factor = \>\"", ",", 
          "pixFactor", ",", 
          "\"\< and image size {slices, rows, columns}=\>\"", ",", " ", 
          RowBox[{"{", 
           RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}], 
          ",", "\"\< took \>\"", ",", " ", 
          RowBox[{"timeEnd", "-", "timeStart"}], ",", " ", "\"\< (s)\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "vectorField", "]"}], ";"}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**", " ", "GRADIENT"}], " ", 
    "ORIENTATION", " ", "FILTER", " ", "3", "D"}], " ", "*************)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"findOrientationGradFilter3D", "[", 
    RowBox[{"img_", ",", " ", 
     RowBox[{"radius_:", "2"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "grad", ",", " ", "graddata", ",", " ", "imgdata", ",", "vectorField", 
       ",", " ", "nSlis", ",", "nRows", ",", " ", "nCols", ",", " ", "vx", 
       ",", " ", "vy", ",", " ", "vz", ",", "theta1", ",", " ", "theta2", ",",
        " ", "t", ",", " ", "spa"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<Inside gradient orientation filter 3d\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"imgdata", " ", "=", " ", 
        RowBox[{"ImageData", "@", "img"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"graddata", " ", "=", 
        RowBox[{"GradientOrientationFilter", "[", 
         RowBox[{"imgdata", ",", "radius", ",", " ", 
          RowBox[{"Method", "\[Rule]", " ", 
           RowBox[{
           "\"\<DerivativeKernel\>\"", "\[Rule]", " ", "\"\<Bessel\>\""}]}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}], "=", 
        RowBox[{"imgdata", "//", "Dimensions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vectorField", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"nSlis", ",", " ", "nRows", ",", " ", "nCols"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t", " ", "=", 
        RowBox[{"N", "@", 
         RowBox[{"FindThreshold", "[", "img", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"theta1", ",", " ", "theta2"}], "}"}], "=", 
            RowBox[{
             RowBox[{"(", "graddata", ")"}], "[", 
             RowBox[{"[", 
              RowBox[{"s", ",", " ", "r", ",", "c"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"imgdata", "[", 
               RowBox[{"[", 
                RowBox[{"s", ",", "r", ",", " ", "c"}], "]"}], "]"}], ">", 
              "t"}], ",", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"vx", "=", 
                RowBox[{"Cos", "[", "theta1", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"vz", "=", 
                RowBox[{
                 RowBox[{"Sin", "[", "theta1", "]"}], 
                 RowBox[{"Cos", "[", "theta2", "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"vy", "=", 
                RowBox[{
                 RowBox[{"Sin", "[", "theta1", "]"}], 
                 RowBox[{"Sin", "[", "theta2", "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"vz", "<", "0"}], ",", 
                 RowBox[{
                  RowBox[{"vz", "=", 
                   RowBox[{"-", "vz"}]}], ";", 
                  RowBox[{"vy", "=", 
                   RowBox[{"-", "vy"}]}], ";", 
                  RowBox[{"vx", "=", 
                   RowBox[{"-", "vx"}]}], ";"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"vectorField", "[", 
                 RowBox[{"[", 
                  RowBox[{"s", ",", " ", "r", ",", "c"}], "]"}], "]"}], "=", 
                RowBox[{"{", 
                 RowBox[{"vx", ",", " ", "vy", ",", " ", "vz"}], "}"}]}], 
               ";"}], "\[IndentingNewLine]", ")"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ")"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", "nSlis"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", " ", "1", ",", " ", "nRows"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"c", ",", " ", "1", ",", " ", "nCols"}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"graddata", ",", "vectorField"}], "}"}], "]"}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7354212364612517`*^9, 3.7354214123352623`*^9}, {
   3.73542149473346*^9, 3.735421508415868*^9}, {3.735421592405143*^9, 
   3.735421625073118*^9}, {3.735421660426151*^9, 3.7354218595991836`*^9}, {
   3.735421929536529*^9, 3.735422108365364*^9}, {3.7354221583773108`*^9, 
   3.7354222212628965`*^9}, {3.7354222633329067`*^9, 
   3.7354224405107365`*^9}, {3.7354224957584243`*^9, 
   3.7354225145544357`*^9}, {3.735422551639106*^9, 3.735422566949847*^9}, {
   3.7354230146699843`*^9, 3.7354233983048735`*^9}, {3.735423430626848*^9, 
   3.7354235579346466`*^9}, {3.735423708157696*^9, 3.7354237086740656`*^9}, {
   3.7354238213977284`*^9, 3.735423859159212*^9}, {3.7354240067013803`*^9, 
   3.735424012017525*^9}, {3.7354243137169275`*^9, 3.735424462477919*^9}, {
   3.735424566818567*^9, 3.735424635574576*^9}, {3.735424694431148*^9, 
   3.735424828677376*^9}, {3.7354252781882277`*^9, 3.735425364556052*^9}, {
   3.7354254508019323`*^9, 3.7354255142718906`*^9}, {3.735425546275756*^9, 
   3.73542612729277*^9}, {3.735426172728631*^9, 3.735426183140375*^9}, {
   3.73542624319448*^9, 3.7354263123033776`*^9}, {3.7354263594127364`*^9, 
   3.73542635960328*^9}, {3.735426399007134*^9, 3.735426472472591*^9}, 
   3.7354265046201773`*^9, {3.735426536313506*^9, 3.7354265445203447`*^9}, {
   3.7354266410371366`*^9, 3.73542669735604*^9}, {3.735426796700404*^9, 
   3.735426872463008*^9}, {3.735426929591363*^9, 3.735426974290305*^9}, {
   3.735427272055041*^9, 3.7354273375382786`*^9}, {3.735427636490128*^9, 
   3.7354276430074215`*^9}, {3.735427710689109*^9, 3.735427715867888*^9}, {
   3.7354278245774736`*^9, 3.735427839289629*^9}, {3.7354279061685867`*^9, 
   3.7354279339665565`*^9}, {3.735428009315059*^9, 3.735428115860586*^9}, {
   3.7354282078788137`*^9, 3.7354283758207426`*^9}, {3.735428575392622*^9, 
   3.7354286610596113`*^9}, {3.7354287401179886`*^9, 
   3.7354287418756666`*^9}, {3.7354289418760242`*^9, 
   3.7354289628047667`*^9}, {3.735429134957675*^9, 3.7354292960518923`*^9}, {
   3.735429412613758*^9, 3.735429429612953*^9}, {3.7354294792139893`*^9, 
   3.735429484157093*^9}, {3.7354295442781224`*^9, 3.7354296162917433`*^9}, {
   3.7354296513470287`*^9, 3.7354297448007107`*^9}, {3.7354298073601766`*^9, 
   3.7354298141733055`*^9}, {3.735429870697728*^9, 3.7354298850408945`*^9}, {
   3.7354299418791*^9, 3.735429960806491*^9}, {3.735430032389939*^9, 
   3.7354300429210014`*^9}, {3.735430091923407*^9, 3.7354301046592965`*^9}, {
   3.7354301399852495`*^9, 3.7354301939468813`*^9}, {3.735430233499132*^9, 
   3.7354303683700185`*^9}, {3.7354304368361745`*^9, 
   3.7354305579404716`*^9}, {3.735430767963333*^9, 3.7354310066174545`*^9}, {
   3.7354310925050006`*^9, 3.735431193461648*^9}, {3.7354312337728815`*^9, 
   3.735431245101017*^9}, {3.7354312922054033`*^9, 3.7354313933070393`*^9}, {
   3.7354314492749214`*^9, 3.735431592013748*^9}, {3.7354316324684343`*^9, 
   3.735431640453689*^9}, {3.7354317296285367`*^9, 3.735431734404282*^9}, 
   3.7354317711649857`*^9, {3.735431829776588*^9, 3.7354318684554443`*^9}, {
   3.7354319544888706`*^9, 3.735432023309003*^9}, {3.7354323020460167`*^9, 
   3.735432341853983*^9}, {3.7354324182643075`*^9, 3.735432419533692*^9}, {
   3.7354324631227627`*^9, 3.735432466952908*^9}, {3.735432629375261*^9, 
   3.7354326296229153`*^9}, {3.735432667643053*^9, 3.735432777985627*^9}, 
   3.7354329524177938`*^9, {3.7354330453831763`*^9, 3.735433062831659*^9}, {
   3.7354331217513885`*^9, 3.7354335305151024`*^9}, {3.7354336123308196`*^9, 
   3.7354336984078693`*^9}, {3.735433755629208*^9, 3.735433755729399*^9}, {
   3.7354339150403194`*^9, 3.7354339751783886`*^9}, {3.735434176501494*^9, 
   3.73543418633667*^9}, {3.7354343541321745`*^9, 3.735434471687725*^9}, {
   3.7354345639869165`*^9, 3.735434594867087*^9}, {3.7354346744950724`*^9, 
   3.735434723044203*^9}, {3.735434999285278*^9, 3.735435002935993*^9}, {
   3.735435377506064*^9, 3.735435415474414*^9}, {3.735435507540281*^9, 
   3.7354355426357007`*^9}, {3.735435588950966*^9, 3.735435611918076*^9}, {
   3.735435812194939*^9, 3.735435853482813*^9}, {3.735435925366702*^9, 
   3.7354359804873347`*^9}, 3.735436905718177*^9, {3.735436952406381*^9, 
   3.7354369751493864`*^9}, {3.735439380214834*^9, 3.735439387096157*^9}, {
   3.7354394746963944`*^9, 3.7354394753340755`*^9}, {3.7354395698566265`*^9, 
   3.735439570033146*^9}, {3.735439684174746*^9, 3.7354398363316317`*^9}, {
   3.735439898668347*^9, 3.735440181067813*^9}, {3.735440252477708*^9, 
   3.7354402583312373`*^9}, {3.735440364834855*^9, 3.7354403671299257`*^9}, {
   3.73544045010275*^9, 3.7354404615993476`*^9}, {3.735440931823052*^9, 
   3.7354409491772766`*^9}, {3.7354409932555637`*^9, 
   3.7354411705433636`*^9}, {3.7354412219371223`*^9, 3.7354412226119175`*^9}, 
   3.735441253325647*^9, {3.7354413235117245`*^9, 3.735441387955598*^9}, {
   3.7354417163975697`*^9, 3.7354417302454567`*^9}, {3.735441913383952*^9, 
   3.7354419167629433`*^9}, {3.735441949252675*^9, 3.735441971899931*^9}, {
   3.735442046216256*^9, 3.7354421606014605`*^9}, {3.7354423663949614`*^9, 
   3.735442387797914*^9}, {3.735442466209839*^9, 3.735442564754037*^9}, {
   3.7354427428008523`*^9, 3.7354428355416403`*^9}, {3.73544292436036*^9, 
   3.7354429309859886`*^9}, {3.7354430379003563`*^9, 3.735443044693467*^9}, {
   3.7354430790097523`*^9, 3.73544308952474*^9}, {3.735443385328616*^9, 
   3.7354434009166393`*^9}, {3.735456449388738*^9, 3.735456451931535*^9}, {
   3.735456482383536*^9, 3.735456551736084*^9}, {3.7354566040403137`*^9, 
   3.7354566168764224`*^9}, {3.7354566650741625`*^9, 
   3.7354566653448915`*^9}, {3.7354568994116983`*^9, 3.73545692605564*^9}, {
   3.7354570840228415`*^9, 3.735457125536317*^9}, 3.735457184049074*^9, {
   3.7354572828266983`*^9, 3.7354573246971674`*^9}, {3.7354574104826946`*^9, 
   3.735457432100272*^9}, {3.7354585222524366`*^9, 3.7354585530092387`*^9}, {
   3.7354589116901045`*^9, 3.7354589155363398`*^9}, {3.73545896622831*^9, 
   3.7354590159385896`*^9}, {3.735459046443808*^9, 3.7354591745346127`*^9}, {
   3.7354592129909444`*^9, 3.735459262969992*^9}, {3.7354593263004646`*^9, 
   3.735459507148099*^9}, {3.7354595493808565`*^9, 3.7354596275789385`*^9}, {
   3.735460279130254*^9, 3.735460321941177*^9}, {3.7354603592956076`*^9, 
   3.7354603617351017`*^9}, {3.7354605872809753`*^9, 
   3.7354606427152863`*^9}, {3.735460961380823*^9, 3.7354609695365243`*^9}, {
   3.7354609995925093`*^9, 3.7354611101436486`*^9}, {3.735461148113732*^9, 
   3.735461169664074*^9}, {3.735461205760772*^9, 3.735461263778205*^9}, {
   3.735461362771502*^9, 3.7354613628196287`*^9}, {3.7354613939825535`*^9, 
   3.735461407062359*^9}, {3.7354616156687803`*^9, 3.735461663766798*^9}, {
   3.73546188149812*^9, 3.7354619525852804`*^9}, {3.7354619831044407`*^9, 
   3.7354619849633384`*^9}, {3.7354624110234995`*^9, 
   3.7354624165211763`*^9}, {3.735462591890277*^9, 3.735462593352206*^9}, {
   3.735462674517153*^9, 3.7354627052860613`*^9}, {3.7354627461898756`*^9, 
   3.735462825857913*^9}, {3.735462943389223*^9, 3.7354629687566786`*^9}, {
   3.735463003555277*^9, 3.7354630036826553`*^9}, {3.7354630357740097`*^9, 
   3.7354630475985126`*^9}, {3.7354631764042687`*^9, 
   3.7354631768424387`*^9}, {3.735463237046604*^9, 3.7354632425954003`*^9}, {
   3.7354635854797115`*^9, 3.735463590540168*^9}, {3.7354636564805937`*^9, 
   3.735463659835574*^9}, {3.735463770542925*^9, 3.7354637734767756`*^9}, {
   3.7354638632394476`*^9, 3.7354638721571336`*^9}, {3.7354639403052177`*^9, 
   3.7354639404796886`*^9}, {3.735463970510563*^9, 3.7354639744200125`*^9}, {
   3.7354640552048798`*^9, 3.7354640572523785`*^9}, {3.7354641264772735`*^9, 
   3.7354641287513113`*^9}, {3.735464306528021*^9, 3.7354643920757027`*^9}, {
   3.7354644309920015`*^9, 3.7354644409534984`*^9}, {3.735464864048457*^9, 
   3.735464962881813*^9}, {3.735465449094571*^9, 3.7354654511801653`*^9}, {
   3.735465581644029*^9, 3.7354655829184237`*^9}, {3.7354656154648905`*^9, 
   3.7354656794541664`*^9}, {3.735465977647323*^9, 3.7354660035392704`*^9}, {
   3.735466053273609*^9, 3.735466085324892*^9}, {3.7354661171933146`*^9, 
   3.735466170426538*^9}, {3.7354670681652355`*^9, 3.7354672290172195`*^9}, {
   3.7354673142227907`*^9, 3.7354673248941708`*^9}, 3.7354678235938215`*^9, {
   3.7354732925235667`*^9, 3.735473320410774*^9}, {3.735473425091129*^9, 
   3.735473498672932*^9}, 3.7354736847450557`*^9, {3.7354738104309645`*^9, 
   3.735474020672408*^9}, {3.735474069697342*^9, 3.735474075461669*^9}, {
   3.7354741200101666`*^9, 3.7354741357490563`*^9}, {3.7354741781411066`*^9, 
   3.7354741782373486`*^9}, {3.7354742123840017`*^9, 3.735474250057*^9}, {
   3.7354742856461744`*^9, 3.7354743076656246`*^9}, {3.7354743769639745`*^9, 
   3.7354745184304743`*^9}, {3.7354745495143976`*^9, 
   3.7354745764480677`*^9}, {3.735474653897455*^9, 3.7354746561825356`*^9}, {
   3.735474832364354*^9, 3.735474862292994*^9}, {3.735474957477051*^9, 
   3.7354749622256365`*^9}, {3.735475145179346*^9, 3.7354751592447195`*^9}, {
   3.7354752682698426`*^9, 3.735475298594638*^9}, {3.735475545170117*^9, 
   3.73547554823431*^9}, {3.7354756058255215`*^9, 3.7354756456604137`*^9}, {
   3.735475885566719*^9, 3.735476174015279*^9}, {3.735476207818228*^9, 
   3.7354762508266735`*^9}, {3.735476304634857*^9, 3.7354763808446503`*^9}, {
   3.735476478331066*^9, 3.7354765542540913`*^9}, {3.7354766013183327`*^9, 
   3.7354766348535657`*^9}, {3.735477057286726*^9, 3.73547707531671*^9}, {
   3.735477119892053*^9, 3.7354772364812984`*^9}, {3.735477335024294*^9, 
   3.7354773966031094`*^9}, {3.7354774485363045`*^9, 3.7354774836848335`*^9}, 
   3.7354776900592303`*^9, {3.7354778770221443`*^9, 3.7354778827955*^9}, {
   3.7354779643019953`*^9, 3.735477972401553*^9}, {3.735478159199089*^9, 
   3.7354781594096527`*^9}, {3.7354813892544737`*^9, 
   3.7354814822980785`*^9}, {3.7354815313271065`*^9, 3.735481572255066*^9}, {
   3.7354816085146093`*^9, 3.7354816157178288`*^9}, {3.735481683095793*^9, 
   3.7354816838347716`*^9}, {3.735543509430441*^9, 3.735543585378568*^9}, {
   3.735543619107281*^9, 3.7355436478417916`*^9}, {3.735543977720084*^9, 
   3.7355441633474164`*^9}, {3.735544197739463*^9, 3.7355442058049254`*^9}, {
   3.7355444475959835`*^9, 3.735544532550062*^9}, {3.7355446421598177`*^9, 
   3.735544645826543*^9}, {3.735544839886943*^9, 3.735544842425742*^9}, {
   3.7355448864121623`*^9, 3.7355448968509274`*^9}, {3.7355453184624476`*^9, 
   3.7355453218343782`*^9}, {3.735545357973545*^9, 3.7355453758190317`*^9}, {
   3.735545417378623*^9, 3.7355454174778852`*^9}, {3.7355500613914104`*^9, 
   3.735550102812628*^9}, {3.7355501562628207`*^9, 3.735550160004779*^9}, {
   3.735550238414569*^9, 3.735550300951975*^9}, {3.735550619820451*^9, 
   3.73555062280238*^9}, {3.7355508204450073`*^9, 3.7355508918189363`*^9}, {
   3.7355512621163597`*^9, 3.7355512623169255`*^9}, {3.735551296164774*^9, 
   3.7355512966641054`*^9}, {3.735551704623136*^9, 3.735551718594312*^9}, {
   3.735551804055727*^9, 3.7355518100205975`*^9}, {3.735552350807356*^9, 
   3.735552385971084*^9}, {3.7355524230778217`*^9, 3.735552423634344*^9}, {
   3.7355528194526296`*^9, 3.735552850520295*^9}, {3.7355532498207936`*^9, 
   3.735553256738201*^9}, {3.73555330749583*^9, 3.7355533078026466`*^9}, {
   3.735553402073283*^9, 3.7355534188138304`*^9}, {3.7355807909663954`*^9, 
   3.7355808926067734`*^9}, {3.735581141134631*^9, 3.7355811521128783`*^9}, {
   3.7355811823352957`*^9, 3.7355811949177356`*^9}, {3.735581237006734*^9, 
   3.7355812373637276`*^9}, {3.7355815046329923`*^9, 
   3.7355815136700068`*^9}, {3.7355824109707313`*^9, 3.735582442370265*^9}, {
   3.735583083063348*^9, 3.735583190192463*^9}, {3.735583243836209*^9, 
   3.735583379506222*^9}, {3.735583425227879*^9, 3.7355834702797613`*^9}, {
   3.7355838848714333`*^9, 3.7355839475331817`*^9}, {3.735584937532963*^9, 
   3.735584948651532*^9}, {3.7355849822088356`*^9, 3.7355849913611917`*^9}, {
   3.7355850326480603`*^9, 3.7355850785346775`*^9}, {3.735585127143031*^9, 
   3.735585192097875*^9}, 3.735585623538001*^9, {3.7355856938952293`*^9, 
   3.735585732099847*^9}, {3.7355858014604626`*^9, 3.735585837742997*^9}, {
   3.73558659764579*^9, 3.73558659859533*^9}, {3.735586631189014*^9, 
   3.7355866537811737`*^9}, {3.7355867849040475`*^9, 3.735586811175002*^9}, {
   3.735587394374501*^9, 3.735587558193824*^9}, {3.735587597460311*^9, 
   3.735587711511788*^9}, {3.7355887060113163`*^9, 3.7355887652448883`*^9}, {
   3.7355888524449277`*^9, 3.7355888899617596`*^9}, {3.735588939744231*^9, 
   3.7355889796895723`*^9}, {3.7355892139168477`*^9, 
   3.7355892142035637`*^9}, {3.7355892613482423`*^9, 3.7355892629334507`*^9}, 
   3.735589650220251*^9, {3.7355899412990866`*^9, 3.735590141170993*^9}, {
   3.735601077405944*^9, 3.735601087851754*^9}, {3.7356025530162506`*^9, 
   3.7356025877937937`*^9}, {3.735602621773212*^9, 3.7356026798427343`*^9}, {
   3.7356039246979074`*^9, 3.7356039259151645`*^9}, {3.73560422241308*^9, 
   3.735604257285878*^9}, {3.73562119000733*^9, 3.7356212421130285`*^9}, {
   3.7356212995568705`*^9, 3.735621414095683*^9}, {3.735621509552682*^9, 
   3.7356215612883344`*^9}, {3.7356216445458546`*^9, 
   3.7356217699044247`*^9}, {3.7356265257412977`*^9, 3.735626556461052*^9}, {
   3.735630374012297*^9, 3.7356304223980007`*^9}, {3.7356306970326214`*^9, 
   3.735630708590376*^9}, {3.7365221829217176`*^9, 3.7365222132396927`*^9}, {
   3.7365262148447685`*^9, 3.736526219300843*^9}, {3.736526269037611*^9, 
   3.736526271462166*^9}, {3.7365263517064857`*^9, 3.7365263765042095`*^9}, {
   3.7365264394194355`*^9, 3.73652646334265*^9}, {3.7365266171899843`*^9, 
   3.7365266176517477`*^9}, {3.736526721137621*^9, 3.7365267235511613`*^9}, {
   3.7365339379181004`*^9, 3.7365339608547325`*^9}, {3.7365340951342897`*^9, 
   3.7365341551368523`*^9}, {3.736534185507594*^9, 3.7365342684448442`*^9}, {
   3.736534370531856*^9, 3.7365343706425247`*^9}, {3.7365344068238344`*^9, 
   3.736534525486492*^9}, {3.7365347387118187`*^9, 3.736534810536764*^9}, {
   3.736535078406168*^9, 3.7365350827226315`*^9}, {3.736535180317585*^9, 
   3.736535191444829*^9}, {3.7365353553820295`*^9, 3.736535360726668*^9}, {
   3.7365355346545525`*^9, 3.736535536156538*^9}, {3.7365357252361555`*^9, 
   3.736535765436659*^9}, {3.7366729381093163`*^9, 3.7366729402651005`*^9}, {
   3.736672998860664*^9, 3.7366730003603134`*^9}, {3.736673037429725*^9, 
   3.736673037601604*^9}, {3.7366733392043715`*^9, 3.7366733394230704`*^9}, {
   3.7366733706032424`*^9, 3.7366734150525975`*^9}, {3.736673804696596*^9, 
   3.7366738225403075`*^9}, {3.7366739369400263`*^9, 
   3.7366739370587006`*^9}, {3.736674026581915*^9, 3.7366740497683945`*^9}, {
   3.7366822570091867`*^9, 3.7366822968456974`*^9}, 3.7366823287603226`*^9, {
   3.736682458711853*^9, 3.7366824778456907`*^9}, {3.7366825468601503`*^9, 
   3.7366825600628014`*^9}, {3.7366827053078136`*^9, 
   3.7366827128915243`*^9}, {3.736682979281807*^9, 3.73668304437574*^9}, {
   3.7366831826838455`*^9, 3.7366831829301853`*^9}, {3.7366837434903517`*^9, 
   3.7366837460893574`*^9}, {3.7366838280870886`*^9, 3.736683850832307*^9}, {
   3.736684400977378*^9, 3.7366844130986214`*^9}, 3.7366847050056973`*^9, {
   3.7366865317823114`*^9, 3.7366865588758726`*^9}, 3.7366866051860313`*^9, 
   3.7366866478030252`*^9, {3.7366868351901464`*^9, 3.7366868355970216`*^9}, {
   3.7366872582884564`*^9, 3.736687260755272*^9}, {3.736687298799594*^9, 
   3.736687304557192*^9}, {3.7366893391506157`*^9, 3.7366893995022244`*^9}, {
   3.736691590747478*^9, 3.7366916187819924`*^9}, {3.736691659252902*^9, 
   3.736691684867467*^9}, {3.736692075767852*^9, 3.7366920898422165`*^9}, {
   3.736692259294567*^9, 3.7366922730808787`*^9}, {3.736692400815794*^9, 
   3.7366924106355762`*^9}, {3.736693400583624*^9, 3.7366934693355293`*^9}, {
   3.736693538307276*^9, 3.736693543229149*^9}, {3.7366936098547173`*^9, 
   3.7366936183858566`*^9}, {3.736693797228938*^9, 3.736693808733224*^9}, {
   3.736693999651585*^9, 3.7366940057791924`*^9}, {3.7366942582115717`*^9, 
   3.736694340187985*^9}, {3.736694900995369*^9, 3.736694911582287*^9}, {
   3.7366953745401087`*^9, 3.7366954020331335`*^9}, {3.7367071289595118`*^9, 
   3.7367071560670156`*^9}, {3.736707281067209*^9, 3.7367072826310663`*^9}, {
   3.7373283113189692`*^9, 3.737328325727458*^9}, {3.737328597563865*^9, 
   3.7373286315360537`*^9}, {3.73732880433848*^9, 3.7373288454615593`*^9}, {
   3.737328907480609*^9, 3.737328907905487*^9}, {3.7373289594986205`*^9, 
   3.737328959569433*^9}, {3.7373290087529263`*^9, 3.737329032398759*^9}, 
   3.7373291597261715`*^9, {3.7406747278231153`*^9, 
   3.740674729648187*^9}},ExpressionUUID->"bfe8fa11-9563-46be-a8fe-\
d07c06662dfb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"initialize", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7354241173222723`*^9, 
  3.7354241220779276`*^9}},ExpressionUUID->"2864a7ef-6d3f-451c-9239-\
7b259211aa8a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"100", ",", "100", ",", "100"}], "}"}]], "Print",
 CellChangeTimes->{
  3.735581248308809*^9, 3.735583522363434*^9, 3.735586830407404*^9, 
   3.7355884796487474`*^9, 3.7355902314792533`*^9, 3.735626092926911*^9, 
   3.7356304556785655`*^9, {3.735631257216552*^9, 3.7356312647906413`*^9}, 
   3.736522308748929*^9, 3.7365262417898903`*^9, 3.7365263914974785`*^9, 
   3.736526471055047*^9, 3.736526624052676*^9, 3.736526733991959*^9, 
   3.736530244334346*^9, 3.736530307926688*^9, 3.736530494872263*^9, 
   3.7365305703663244`*^9, 3.736534556401227*^9, 3.7365350952755065`*^9, 
   3.736535376704953*^9, 3.7365355468070803`*^9, 3.736535794748021*^9, {
   3.7366733590903254`*^9, 3.7366734247690644`*^9}, 3.73667383349603*^9, 
   3.736682312885815*^9, 3.7366823505969205`*^9, 3.7366824896052065`*^9, 
   3.7366825758894744`*^9, 3.7366827261500344`*^9, 3.7366830629520144`*^9, 
   3.7366838728434052`*^9, 3.7366866717878923`*^9, 3.736687044177368*^9, 
   3.736687322306404*^9, 3.7366894164907584`*^9, 3.736691715027672*^9, 
   3.7366920961244183`*^9, 3.7366922798095894`*^9, 3.736692419023322*^9, {
   3.7366934535906487`*^9, 3.7366934830856485`*^9}, 3.7366935504418287`*^9, 
   3.736693639335693*^9, 3.7366938196739597`*^9, 3.7366940176354866`*^9, {
   3.7366942750585237`*^9, 3.73669429767704*^9}, 3.736694349381118*^9, 
   3.7366949183908825`*^9, 3.7367071692995853`*^9, 3.7367072933393974`*^9, 
   3.7373283587102594`*^9, {3.7373286138193784`*^9, 3.7373286396124363`*^9}, 
   3.73732885962833*^9, 3.7373289166699996`*^9, 
   3.7373290496963367`*^9},ExpressionUUID->"f40fe259-0c2f-41a1-8632-\
c05556d13656"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"perform", "[", "]"}]], "Input",
 CellChangeTimes->{{3.735427660407775*^9, 
  3.735427662276697*^9}},ExpressionUUID->"ba1c0277-bfdc-42b5-92b3-\
9d359ff3522b"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Moment of Inertia Algorithm\"\>"], "Print",
 CellChangeTimes->{
  3.7356260964981127`*^9, 3.7356304592721224`*^9, 3.7356312689679527`*^9, 
   3.736522317505987*^9, 3.7365262795325947`*^9, 3.7365263959157577`*^9, 
   3.736526473729291*^9, 3.736526641684041*^9, 3.7365267385287733`*^9, 
   3.73653057323746*^9, 3.736534559568079*^9, 3.7365351021039033`*^9, 
   3.736535388815539*^9, 3.73653579821806*^9, 3.736673450060027*^9, 
   3.736673836087088*^9, 3.736682357660074*^9, 3.7366824939166727`*^9, 
   3.736682582222536*^9, 3.736682729048283*^9, 3.73668306699321*^9, 
   3.736683876257275*^9, 3.736686678495983*^9, 3.7366870559271917`*^9, 
   3.736687327882489*^9, 3.7366894259953785`*^9, 3.736691718481219*^9, 
   3.7366920999481916`*^9, 3.7366922819930553`*^9, 3.7366924235542264`*^9, 
   3.736693485023758*^9, 3.736693553553221*^9, {3.7366936262109313`*^9, 
   3.736693643334032*^9}, 3.7366938220515585`*^9, 3.7366940225563283`*^9, 
   3.7366943541012087`*^9, 3.736694923901799*^9, 3.7367072956771517`*^9, 
   3.737328367947611*^9, 3.7373286428537807`*^9, 3.737328861905394*^9, 
   3.737328923242498*^9, {3.7373290412221823`*^9, 
   3.7373290516999207`*^9}},ExpressionUUID->"106ae149-21b1-43fd-a2b6-\
4b7806175c9a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Moment of Inertia one pass with iteration factor = \"\>", 
   "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\" and image size {slices, rows, columns}=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"100", ",", "100", ",", "100"}], "}"}], 
   "\[InvisibleSpace]", "\<\" took \"\>", "\[InvisibleSpace]", 
   "3.9530000000000314`", "\[InvisibleSpace]", "\<\" (s)\"\>"}],
  SequenceForm[
  "Moment of Inertia one pass with iteration factor = ", 5, 
   " and image size {slices, rows, columns}=", {100, 100, 100}, " took ", 
   3.9530000000000314`, " (s)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7356260964981127`*^9, 3.7356304592721224`*^9, 3.7356312689679527`*^9, 
   3.736522317505987*^9, 3.7365262795325947`*^9, 3.7365263959157577`*^9, 
   3.736526473729291*^9, 3.736526641684041*^9, 3.7365267385287733`*^9, 
   3.73653057323746*^9, 3.736534559568079*^9, 3.7365351021039033`*^9, 
   3.736535388815539*^9, 3.73653579821806*^9, 3.736673450060027*^9, 
   3.736673836087088*^9, 3.736682357660074*^9, 3.7366824939166727`*^9, 
   3.736682582222536*^9, 3.736682729048283*^9, 3.73668306699321*^9, 
   3.736683876257275*^9, 3.736686678495983*^9, 3.7366870559271917`*^9, 
   3.736687327882489*^9, 3.7366894259953785`*^9, 3.736691718481219*^9, 
   3.7366920999481916`*^9, 3.7366922819930553`*^9, 3.7366924235542264`*^9, 
   3.736693485023758*^9, 3.736693553553221*^9, {3.7366936262109313`*^9, 
   3.736693643334032*^9}, 3.7366938220515585`*^9, 3.7366940225563283`*^9, 
   3.7366943541012087`*^9, 3.736694923901799*^9, 3.7367072956771517`*^9, 
   3.737328367947611*^9, 3.7373286428537807`*^9, 3.737328861905394*^9, 
   3.737328923242498*^9, {3.7373290412221823`*^9, 
   3.7373290556912537`*^9}},ExpressionUUID->"ce84c6fe-44ba-42ac-91e4-\
2872930ecc57"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Moment of Inertia one pass with iteration factor = \"\>", 
   "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\" and image size {slices, rows, columns}=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"100", ",", "100", ",", "100"}], "}"}], 
   "\[InvisibleSpace]", "\<\" took \"\>", "\[InvisibleSpace]", 
   "4.046999999999969`", "\[InvisibleSpace]", "\<\" (s)\"\>"}],
  SequenceForm[
  "Moment of Inertia one pass with iteration factor = ", 9, 
   " and image size {slices, rows, columns}=", {100, 100, 100}, " took ", 
   4.046999999999969, " (s)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7356260964981127`*^9, 3.7356304592721224`*^9, 3.7356312689679527`*^9, 
   3.736522317505987*^9, 3.7365262795325947`*^9, 3.7365263959157577`*^9, 
   3.736526473729291*^9, 3.736526641684041*^9, 3.7365267385287733`*^9, 
   3.73653057323746*^9, 3.736534559568079*^9, 3.7365351021039033`*^9, 
   3.736535388815539*^9, 3.73653579821806*^9, 3.736673450060027*^9, 
   3.736673836087088*^9, 3.736682357660074*^9, 3.7366824939166727`*^9, 
   3.736682582222536*^9, 3.736682729048283*^9, 3.73668306699321*^9, 
   3.736683876257275*^9, 3.736686678495983*^9, 3.7366870559271917`*^9, 
   3.736687327882489*^9, 3.7366894259953785`*^9, 3.736691718481219*^9, 
   3.7366920999481916`*^9, 3.7366922819930553`*^9, 3.7366924235542264`*^9, 
   3.736693485023758*^9, 3.736693553553221*^9, {3.7366936262109313`*^9, 
   3.736693643334032*^9}, 3.7366938220515585`*^9, 3.7366940225563283`*^9, 
   3.7366943541012087`*^9, 3.736694923901799*^9, 3.7367072956771517`*^9, 
   3.737328367947611*^9, 3.7373286428537807`*^9, 3.737328861905394*^9, 
   3.737328923242498*^9, {3.7373290412221823`*^9, 
   3.7373290599179525`*^9}},ExpressionUUID->"eba2810e-2ddb-44cc-9a70-\
0f2d36ed9847"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Moment of Inertia one pass with iteration factor = \"\>", 
   "\[InvisibleSpace]", "13", 
   "\[InvisibleSpace]", "\<\" and image size {slices, rows, columns}=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"100", ",", "100", ",", "100"}], "}"}], 
   "\[InvisibleSpace]", "\<\" took \"\>", "\[InvisibleSpace]", 
   "4.687000000000012`", "\[InvisibleSpace]", "\<\" (s)\"\>"}],
  SequenceForm[
  "Moment of Inertia one pass with iteration factor = ", 13, 
   " and image size {slices, rows, columns}=", {100, 100, 100}, " took ", 
   4.687000000000012, " (s)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7356260964981127`*^9, 3.7356304592721224`*^9, 3.7356312689679527`*^9, 
   3.736522317505987*^9, 3.7365262795325947`*^9, 3.7365263959157577`*^9, 
   3.736526473729291*^9, 3.736526641684041*^9, 3.7365267385287733`*^9, 
   3.73653057323746*^9, 3.736534559568079*^9, 3.7365351021039033`*^9, 
   3.736535388815539*^9, 3.73653579821806*^9, 3.736673450060027*^9, 
   3.736673836087088*^9, 3.736682357660074*^9, 3.7366824939166727`*^9, 
   3.736682582222536*^9, 3.736682729048283*^9, 3.73668306699321*^9, 
   3.736683876257275*^9, 3.736686678495983*^9, 3.7366870559271917`*^9, 
   3.736687327882489*^9, 3.7366894259953785`*^9, 3.736691718481219*^9, 
   3.7366920999481916`*^9, 3.7366922819930553`*^9, 3.7366924235542264`*^9, 
   3.736693485023758*^9, 3.736693553553221*^9, {3.7366936262109313`*^9, 
   3.736693643334032*^9}, 3.7366938220515585`*^9, 3.7366940225563283`*^9, 
   3.7366943541012087`*^9, 3.736694923901799*^9, 3.7367072956771517`*^9, 
   3.737328367947611*^9, 3.7373286428537807`*^9, 3.737328861905394*^9, 
   3.737328923242498*^9, {3.7373290412221823`*^9, 
   3.7373290648208494`*^9}},ExpressionUUID->"19847158-5aec-402d-bdce-\
7c93abb961d1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Lengths of tp1s and tp2s: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1728", ",", "1728"}], "}"}]}],
  SequenceForm["Lengths of tp1s and tp2s: ", {1728, 1728}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7356260964981127`*^9, 3.7356304592721224`*^9, 3.7356312689679527`*^9, 
   3.736522317505987*^9, 3.7365262795325947`*^9, 3.7365263959157577`*^9, 
   3.736526473729291*^9, 3.736526641684041*^9, 3.7365267385287733`*^9, 
   3.73653057323746*^9, 3.736534559568079*^9, 3.7365351021039033`*^9, 
   3.736535388815539*^9, 3.73653579821806*^9, 3.736673450060027*^9, 
   3.736673836087088*^9, 3.736682357660074*^9, 3.7366824939166727`*^9, 
   3.736682582222536*^9, 3.736682729048283*^9, 3.73668306699321*^9, 
   3.736683876257275*^9, 3.736686678495983*^9, 3.7366870559271917`*^9, 
   3.736687327882489*^9, 3.7366894259953785`*^9, 3.736691718481219*^9, 
   3.7366920999481916`*^9, 3.7366922819930553`*^9, 3.7366924235542264`*^9, 
   3.736693485023758*^9, 3.736693553553221*^9, {3.7366936262109313`*^9, 
   3.736693643334032*^9}, 3.7366938220515585`*^9, 3.7366940225563283`*^9, 
   3.7366943541012087`*^9, 3.736694923901799*^9, 3.7367072956771517`*^9, 
   3.737328367947611*^9, 3.7373286428537807`*^9, 3.737328861905394*^9, 
   3.737328923242498*^9, 3.7373290412221823`*^9, 
   3.737329130203086*^9},ExpressionUUID->"f8661daf-bc2a-4df1-a7b0-\
44ad763773b6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Lengths of pp1s and pp2s: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1728", ",", "1728"}], "}"}]}],
  SequenceForm["Lengths of pp1s and pp2s: ", {1728, 1728}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7356260964981127`*^9, 3.7356304592721224`*^9, 3.7356312689679527`*^9, 
   3.736522317505987*^9, 3.7365262795325947`*^9, 3.7365263959157577`*^9, 
   3.736526473729291*^9, 3.736526641684041*^9, 3.7365267385287733`*^9, 
   3.73653057323746*^9, 3.736534559568079*^9, 3.7365351021039033`*^9, 
   3.736535388815539*^9, 3.73653579821806*^9, 3.736673450060027*^9, 
   3.736673836087088*^9, 3.736682357660074*^9, 3.7366824939166727`*^9, 
   3.736682582222536*^9, 3.736682729048283*^9, 3.73668306699321*^9, 
   3.736683876257275*^9, 3.736686678495983*^9, 3.7366870559271917`*^9, 
   3.736687327882489*^9, 3.7366894259953785`*^9, 3.736691718481219*^9, 
   3.7366920999481916`*^9, 3.7366922819930553`*^9, 3.7366924235542264`*^9, 
   3.736693485023758*^9, 3.736693553553221*^9, {3.7366936262109313`*^9, 
   3.736693643334032*^9}, 3.7366938220515585`*^9, 3.7366940225563283`*^9, 
   3.7366943541012087`*^9, 3.736694923901799*^9, 3.7367072956771517`*^9, 
   3.737328367947611*^9, 3.7373286428537807`*^9, 3.737328861905394*^9, 
   3.737328923242498*^9, 3.7373290412221823`*^9, 
   3.737329130208073*^9},ExpressionUUID->"6c6a3c0a-816f-49f7-8391-\
c68fd608749e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"For moment of inertia summation, {thetaError, phiError} = \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4.085648148148148`", ",", "19.537037037037038`"}], "}"}]}],
  SequenceForm[
  "For moment of inertia summation, {thetaError, phiError} = ", {
   4.085648148148148, 19.537037037037038`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7356260964981127`*^9, 3.7356304592721224`*^9, 3.7356312689679527`*^9, 
   3.736522317505987*^9, 3.7365262795325947`*^9, 3.7365263959157577`*^9, 
   3.736526473729291*^9, 3.736526641684041*^9, 3.7365267385287733`*^9, 
   3.73653057323746*^9, 3.736534559568079*^9, 3.7365351021039033`*^9, 
   3.736535388815539*^9, 3.73653579821806*^9, 3.736673450060027*^9, 
   3.736673836087088*^9, 3.736682357660074*^9, 3.7366824939166727`*^9, 
   3.736682582222536*^9, 3.736682729048283*^9, 3.73668306699321*^9, 
   3.736683876257275*^9, 3.736686678495983*^9, 3.7366870559271917`*^9, 
   3.736687327882489*^9, 3.7366894259953785`*^9, 3.736691718481219*^9, 
   3.7366920999481916`*^9, 3.7366922819930553`*^9, 3.7366924235542264`*^9, 
   3.736693485023758*^9, 3.736693553553221*^9, {3.7366936262109313`*^9, 
   3.736693643334032*^9}, 3.7366938220515585`*^9, 3.7366940225563283`*^9, 
   3.7366943541012087`*^9, 3.736694923901799*^9, 3.7367072956771517`*^9, 
   3.737328367947611*^9, 3.7373286428537807`*^9, 3.737328861905394*^9, 
   3.737328923242498*^9, 3.7373290412221823`*^9, 
   3.737329130213059*^9},ExpressionUUID->"cd83cac2-1da7-42e6-a21f-\
f71c18b69389"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Time taken for Moment of Inertia: \"\>", "\[InvisibleSpace]", 
   "75.01600000000002`", "\[InvisibleSpace]", "\<\" (s)\"\>"}],
  SequenceForm[
  "Time taken for Moment of Inertia: ", 75.01600000000002, " (s)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7356260964981127`*^9, 3.7356304592721224`*^9, 3.7356312689679527`*^9, 
   3.736522317505987*^9, 3.7365262795325947`*^9, 3.7365263959157577`*^9, 
   3.736526473729291*^9, 3.736526641684041*^9, 3.7365267385287733`*^9, 
   3.73653057323746*^9, 3.736534559568079*^9, 3.7365351021039033`*^9, 
   3.736535388815539*^9, 3.73653579821806*^9, 3.736673450060027*^9, 
   3.736673836087088*^9, 3.736682357660074*^9, 3.7366824939166727`*^9, 
   3.736682582222536*^9, 3.736682729048283*^9, 3.73668306699321*^9, 
   3.736683876257275*^9, 3.736686678495983*^9, 3.7366870559271917`*^9, 
   3.736687327882489*^9, 3.7366894259953785`*^9, 3.736691718481219*^9, 
   3.7366920999481916`*^9, 3.7366922819930553`*^9, 3.7366924235542264`*^9, 
   3.736693485023758*^9, 3.736693553553221*^9, {3.7366936262109313`*^9, 
   3.736693643334032*^9}, 3.7366938220515585`*^9, 3.7366940225563283`*^9, 
   3.7366943541012087`*^9, 3.736694923901799*^9, 3.7367072956771517`*^9, 
   3.737328367947611*^9, 3.7373286428537807`*^9, 3.737328861905394*^9, 
   3.737328923242498*^9, 3.7373290412221823`*^9, 
   3.737329130218046*^9},ExpressionUUID->"098c0553-ab4b-40fd-97f0-\
4b14bcdb4fe4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total time consumed was: \"\>", "\[InvisibleSpace]", 
   "75.01600000000002`", "\[InvisibleSpace]", "\<\" (s)\"\>"}],
  SequenceForm["Total time consumed was: ", 75.01600000000002, " (s)"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7356260964981127`*^9, 3.7356304592721224`*^9, 3.7356312689679527`*^9, 
   3.736522317505987*^9, 3.7365262795325947`*^9, 3.7365263959157577`*^9, 
   3.736526473729291*^9, 3.736526641684041*^9, 3.7365267385287733`*^9, 
   3.73653057323746*^9, 3.736534559568079*^9, 3.7365351021039033`*^9, 
   3.736535388815539*^9, 3.73653579821806*^9, 3.736673450060027*^9, 
   3.736673836087088*^9, 3.736682357660074*^9, 3.7366824939166727`*^9, 
   3.736682582222536*^9, 3.736682729048283*^9, 3.73668306699321*^9, 
   3.736683876257275*^9, 3.736686678495983*^9, 3.7366870559271917`*^9, 
   3.736687327882489*^9, 3.7366894259953785`*^9, 3.736691718481219*^9, 
   3.7366920999481916`*^9, 3.7366922819930553`*^9, 3.7366924235542264`*^9, 
   3.736693485023758*^9, 3.736693553553221*^9, {3.7366936262109313`*^9, 
   3.736693643334032*^9}, 3.7366938220515585`*^9, 3.7366940225563283`*^9, 
   3.7366943541012087`*^9, 3.736694923901799*^9, 3.7367072956771517`*^9, 
   3.737328367947611*^9, 3.7373286428537807`*^9, 3.737328861905394*^9, 
   3.737328923242498*^9, 3.7373290412221823`*^9, 
   3.737329130222035*^9},ExpressionUUID->"d7e261ca-34f6-4277-a645-\
d43310093598"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"*", "Post", " ", 
    RowBox[{"Processing", " ", ":", " ", 
     RowBox[{
     "Viewing", " ", "Vector", " ", "Plots", " ", "after", " ", "the", " ", 
      "algorithm", " ", "has", " ", "been", " ", "run"}]}]}], "**)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"ListVectorPlot3D", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", " ", 
         RowBox[{"Axes", "\[Rule]", "True"}], ",", 
         RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", 
         RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
         RowBox[{"VectorStyle", "\[Rule]", "\"\<Arrow3D\>\""}], ",", 
         RowBox[{"VectorPoints", "\[Rule]", "20"}], ",", 
         RowBox[{"VectorColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
         " ", 
         RowBox[{"VectorScale", "\[Rule]", "Small"}]}], "]"}], "]"}], " ", 
      "&"}], " ", "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vfs1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"vfs1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"vfs1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"vfs1", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{"vfs2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"vfs2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"vfs2", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"vfs2", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "vf1", ",", "ivf1", ",", "vf2", 
       ",", "vf3", ",", "ivf3", ",", "vf"}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"ListVectorPlot3D", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", 
        RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
        RowBox[{"VectorStyle", "\[Rule]", "\"\<Arrow3D\>\""}], ",", 
        RowBox[{"VectorPoints", "\[Rule]", "40"}], ",", 
        RowBox[{"VectorColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
        " ", 
        RowBox[{"VectorScale", "\[Rule]", "Small"}]}], "]"}], "]"}], " ", 
     "&"}], " ", "/@", 
    RowBox[{"{", "vf2", "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7355824718557296`*^9, 3.7355825725526943`*^9}, {
   3.7355826495134907`*^9, 3.735582775462324*^9}, {3.7355828319897165`*^9, 
   3.7355828328169565`*^9}, {3.735582897414503*^9, 3.735582903753369*^9}, {
   3.735582968269046*^9, 3.7355829684354734`*^9}, {3.735584241263192*^9, 
   3.735584297954026*^9}, {3.735584346900241*^9, 3.735584413578721*^9}, {
   3.735584546609705*^9, 3.735584638913331*^9}, {3.7355847248640018`*^9, 
   3.735584772197994*^9}, {3.7355854765639143`*^9, 3.735585492109276*^9}, {
   3.7355855416099954`*^9, 3.7355855703404074`*^9}, {3.735587177268792*^9, 
   3.735587247081563*^9}, {3.7355890835098276`*^9, 3.7355890934823265`*^9}, {
   3.735590433681522*^9, 3.735590438326887*^9}, {3.735590630995538*^9, 
   3.735590631186039*^9}, {3.735590676713196*^9, 3.7355906812863555`*^9}, {
   3.735590723937859*^9, 3.735590783167469*^9}, {3.73559081639187*^9, 
   3.7355908826923375`*^9}, {3.7355909184494953`*^9, 
   3.7355909185386906`*^9}, {3.73559097801997*^9, 3.7355909944426627`*^9}, {
   3.735591296302335*^9, 3.735591310083966*^9}, {3.7355913723265924`*^9, 
   3.7355913727938356`*^9}, {3.735591425330679*^9, 3.7355914798958797`*^9}, {
   3.7355915508686914`*^9, 3.7355915653772907`*^9}, {3.7355916939784813`*^9, 
   3.7355916975881195`*^9}, {3.735596709630668*^9, 3.7355967098352118`*^9}, {
   3.7356043141875987`*^9, 3.7356043269475875`*^9}, 3.735626251772334*^9, {
   3.735626324390584*^9, 3.7356263286088057`*^9}, {3.7356265019530077`*^9, 
   3.7356265089446106`*^9}, {3.7356271497463474`*^9, 3.735627149925829*^9}, {
   3.735627180624473*^9, 3.735627181281217*^9}, {3.735628885745906*^9, 
   3.735628934641061*^9}, {3.735630756374481*^9, 3.7356307570282593`*^9}, {
   3.735631028832681*^9, 3.7356310296849084`*^9}, {3.7356314420691786`*^9, 
   3.7356314518712096`*^9}, {3.735631680228629*^9, 3.7356316811290045`*^9}, {
   3.7365312639945126`*^9, 3.736531301964018*^9}, {3.7366737231027412`*^9, 
   3.7366737232317944`*^9}, {3.7366918735424213`*^9, 
   3.7366919055797467`*^9}, {3.7366919426705675`*^9, 
   3.7366919427782774`*^9}, {3.7366920022871475`*^9, 3.736692002418812*^9}, {
   3.736707361274769*^9, 3.736707361378452*^9}, {3.7367074165108232`*^9, 
   3.7367074166684384`*^9}, {3.737328376964469*^9, 3.7373284228049393`*^9}, {
   3.7373287265064855`*^9, 3.737328727239526*^9}, {3.7373288865924387`*^9, 
   3.737328886712087*^9}},ExpressionUUID->"7bc71462-38e8-4540-8a93-\
ad5cdc2b8e1a"]
},
WindowSize->{766, 812},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 225376, 4888, 17275, "Input",ExpressionUUID->"bfe8fa11-9563-46be-a8fe-d07c06662dfb"],
Cell[CellGroupData[{
Cell[225959, 4912, 188, 4, 28, "Input",ExpressionUUID->"2864a7ef-6d3f-451c-9239-7b259211aa8a"],
Cell[226150, 4918, 1645, 25, 22, "Print",ExpressionUUID->"f40fe259-0c2f-41a1-8632-c05556d13656"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227832, 4948, 181, 4, 28, "Input",ExpressionUUID->"ba1c0277-bfdc-42b5-92b3-9d359ff3522b"],
Cell[CellGroupData[{
Cell[228038, 4956, 1234, 18, 22, "Print",ExpressionUUID->"106ae149-21b1-43fd-a2b6-4b7806175c9a"],
Cell[229275, 4976, 1826, 32, 41, "Print",ExpressionUUID->"ce84c6fe-44ba-42ac-91e4-2872930ecc57"],
Cell[231104, 5010, 1823, 32, 41, "Print",ExpressionUUID->"eba2810e-2ddb-44cc-9a70-0f2d36ed9847"],
Cell[232930, 5044, 1825, 32, 41, "Print",ExpressionUUID->"19847158-5aec-402d-bdce-7c93abb961d1"],
Cell[234758, 5078, 1423, 24, 22, "Print",ExpressionUUID->"f8661daf-bc2a-4df1-a7b0-44ad763773b6"],
Cell[236184, 5104, 1423, 24, 22, "Print",ExpressionUUID->"6c6a3c0a-816f-49f7-8391-c68fd608749e"],
Cell[237610, 5130, 1553, 27, 22, "Print",ExpressionUUID->"cd83cac2-1da7-42e6-a21f-f71c18b69389"],
Cell[239166, 5159, 1458, 24, 22, "Print",ExpressionUUID->"098c0553-ab4b-40fd-97f0-4b14bcdb4fe4"],
Cell[240627, 5185, 1437, 23, 22, "Print",ExpressionUUID->"d7e261ca-34f6-4277-a645-d43310093598"]
}, Open  ]]
}, Open  ]],
Cell[242091, 5212, 5462, 110, 219, "Input",ExpressionUUID->"7bc71462-38e8-4540-8a93-ad5cdc2b8e1a"]
}
]
*)

